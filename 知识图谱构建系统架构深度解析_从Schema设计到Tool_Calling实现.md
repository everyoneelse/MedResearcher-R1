# çŸ¥è¯†å›¾è°±æ„å»ºç³»ç»Ÿæ¶æ„æ·±åº¦è§£æï¼šä»Schemaè®¾è®¡åˆ°Tool Callingå®ç°

## å¯¹è¯è®°å½•

### ç”¨æˆ·æŸ¥è¯¢1ï¼šè¿™é¡¹å·¥ä½œä¸­ï¼ŒçŸ¥è¯†å›¾è°±çš„æ„å»ºä¸­schemaåœ¨å“ªé‡Œä½“ç°

æˆ‘å¸®ä½ æ·±å…¥åˆ†æäº†çŸ¥è¯†å›¾è°±æ„å»ºé¡¹ç›®ä¸­schemaçš„å…·ä½“ä½“ç°ä½ç½®ã€‚è®©æˆ‘æ¢ç´¢é¡¹ç›®ç»“æ„æ¥ç†è§£schemaåœ¨ä»£ç ä¸­çš„å®šä¹‰ã€‚

é€šè¿‡å¯¹ä»£ç çš„æ·±å…¥åˆ†æï¼Œæˆ‘å‘ç°åœ¨è¿™ä¸ªçŸ¥è¯†å›¾è°±æ„å»ºé¡¹ç›®ä¸­ï¼Œ**schemaä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªå…³é”®ä½ç½®**ï¼š

#### 1. å®ä½“ç±»å‹Schemaå®šä¹‰

**ä¸»è¦ä½ç½®ï¼š** `/workspace/KnowledgeGraphConstruction/lib/graphrag_builder.py`

åœ¨ç¬¬1544è¡Œï¼Œå®šä¹‰äº†å®Œæ•´çš„å®ä½“ç±»å‹schemaï¼š
```python
**å®ä½“ç±»å‹**ï¼šperson, organization, location, technology, concept, event, time
```

è¿™ä¸ªschemaåœ¨ä¸¤ä¸ªåœ°æ–¹è¢«ä½¿ç”¨ï¼š

##### A. LLMæç¤ºè¯ä¸­çš„Schemaçº¦æŸ
åœ¨ `_extract_entities_with_llm` æ–¹æ³•ä¸­ï¼ˆç¬¬1544è¡Œï¼‰ï¼Œé€šè¿‡æç¤ºè¯æ˜ç¡®å®šä¹‰äº†7ç§å®ä½“ç±»å‹ï¼š
- `person` - äººç‰©
- `organization` - ç»„ç»‡æœºæ„  
- `location` - åœ°ç†ä½ç½®
- `technology` - æŠ€æœ¯æ¦‚å¿µ
- `concept` - ä¸€èˆ¬æ¦‚å¿µ
- `event` - äº‹ä»¶
- `time` - æ—¶é—´

##### B. GraphRAGé…ç½®ä¸­çš„Schema
åœ¨ç¬¬298è¡Œï¼ŒGraphRAGçš„é…ç½®æ–‡ä»¶ä¸­ä¹Ÿä½“ç°äº†å®ä½“ç±»å‹schemaï¼š
```python
entity_extraction_config += "entity_types: [person, organization, location, concept, technology, event]\n"
```

#### 2. å®ä½“ç»“æ„Schema

**å®ä½“æ•°æ®ç»“æ„schema** åœ¨å¤šä¸ªåœ°æ–¹ä½“ç°ï¼š

##### A. å®ä½“ç”Ÿæˆæ¨¡æ¿ï¼ˆç¬¬1531-1535è¡Œï¼‰
```json
{
    "entities": [
        {"name": "è‹¹æœå…¬å¸", "type": "organization", "description": ""},
        {"name": "è‹¹æœå‘å¸ƒiPhone15", "type": "event", "description": ""},
        {"name": "2024å¹´03æœˆ15æ—¥", "type": "time", "description": ""},
        {"name": "iPhone15", "type": "technology", "description": ""}
    ]
}
```

##### B. å®ä½“IDç”ŸæˆSchemaï¼ˆç¬¬144è¡Œï¼‰
```python
def _generate_entity_id(self, name: str, entity_type: str, description: str) -> str:
```
æ¯ä¸ªå®ä½“éƒ½æœ‰å”¯ä¸€çš„IDã€åç§°ã€ç±»å‹å’Œæè¿°å››ä¸ªæ ¸å¿ƒå±æ€§ã€‚

#### 3. å…³ç³»Schemaå®šä¹‰

**å…³ç³»ç»“æ„schema** ä½“ç°åœ¨ï¼š

##### A. å…³ç³»æ•°æ®æ¨¡æ¿ï¼ˆç¬¬1537-1541è¡Œï¼‰
```json
{
    "relationships": [
        {"source": "è‹¹æœå…¬å¸", "relation": "å‘èµ·", "target": "è‹¹æœå‘å¸ƒiPhone15"},
        {"source": "è‹¹æœå‘å¸ƒiPhone15", "relation": "å‘ç”Ÿäº", "target": "2024å¹´03æœˆ15æ—¥"},
        {"source": "è‹¹æœå‘å¸ƒiPhone15", "relation": "æ¨å‡º", "target": "iPhone15"}
    ]
}
```

##### B. å…³ç³»è´¨é‡è¿‡æ»¤Schemaï¼ˆç¬¬2269è¡Œï¼‰
```python
def _is_high_quality_relationship(self, relation_type: str) -> bool:
```
å®šä¹‰äº†é«˜è´¨é‡å…³ç³»çš„æ ‡å‡†ï¼Œé¿å…"ç›¸å…³"ã€"å…³è”"ç­‰æ¨¡ç³Šå…³ç³»ã€‚

#### 4. Wikidataå®ä½“é“¾æ¥Schema

**ä½ç½®ï¼š** `/workspace/KnowledgeGraphConstruction/lib/entity_linker.py`

å®ä½“é“¾æ¥çš„è¿”å›schemaï¼ˆç¬¬41-49è¡Œï¼‰ï¼š
```python
{
    'success': bool,
    'standard_name': str,
    'wikidata_id': str,  # Qå¼€å¤´çš„ID
    'description': str,
    'aliases': List[str],
    'properties': Dict[str, List[str]],
    'url': str,
    'confidence': float
}
```

#### 5. å›¾ç»“æ„Schemaçº¦æŸ

**çº¦æŸè§„åˆ™** åœ¨æç¤ºè¯ä¸­æ˜ç¡®å®šä¹‰ï¼ˆç¬¬1546-1553è¡Œï¼‰ï¼š

1. **é¿å…é‡å¤**ï¼šæ£€æŸ¥å·²æœ‰å®ä½“å’Œå…³ç³»
2. **äº‹ä»¶å®ä½“å‘½å**ï¼šä½¿ç”¨"ä¸»ä½“+åŠ¨ä½œ+å®¢ä½“"æ ¼å¼
3. **æ—¶é—´æ ¼å¼**ï¼šä¸¥æ ¼çš„æ—¶é—´è¡¨ç¤ºæ ¼å¼
4. **å…³ç³»æ˜ç¡®æ€§**ï¼šä½¿ç”¨å…·ä½“åŠ¨è¯
5. **ç¦æ­¢å­¤ç«‹å®ä½“**ï¼šæ¯ä¸ªå®ä½“å¿…é¡»å‚ä¸å…³ç³»
6. **å®ä½“å…³ç³»ä¸€è‡´æ€§**ï¼šç¡®ä¿å¼•ç”¨å®Œæ•´æ€§

#### æ€»ç»“

è¿™ä¸ªé¡¹ç›®ä¸­çš„çŸ¥è¯†å›¾è°±schemaä¸»è¦é€šè¿‡ä»¥ä¸‹æ–¹å¼ä½“ç°ï¼š

1. **ç¡¬ç¼–ç çš„å®ä½“ç±»å‹å®šä¹‰** - åœ¨LLMæç¤ºè¯å’ŒGraphRAGé…ç½®ä¸­
2. **ç»“æ„åŒ–çš„æ•°æ®æ¨¡æ¿** - JSONæ ¼å¼çš„å®ä½“å’Œå…³ç³»æ¨¡æ¿
3. **éªŒè¯å’Œè¿‡æ»¤è§„åˆ™** - ç¡®ä¿æ•°æ®è´¨é‡çš„schemaçº¦æŸ
4. **å¤–éƒ¨çŸ¥è¯†åº“é›†æˆ** - é€šè¿‡Wikidataå®ç°æ ‡å‡†åŒ–çš„å®ä½“é“¾æ¥

è¿™ç§è®¾è®¡æ—¢ä¿è¯äº†çŸ¥è¯†å›¾è°±çš„ç»“æ„åŒ–ï¼Œåˆé€šè¿‡LLMçš„çµæ´»æ€§å®ç°äº†åŠ¨æ€çš„çŸ¥è¯†æŠ½å–å’Œå›¾æ„å»ºã€‚

---

### ç”¨æˆ·æŸ¥è¯¢2ï¼šä»–æåˆ°äº†Smart Auto-Taggingï¼Œå…·ä½“ä½“ç°åœ¨å“ªé‡Œ

æˆ‘æœç´¢äº†Smart Auto-TaggingåŠŸèƒ½åœ¨ä»£ç åº“ä¸­çš„å…·ä½“å®ç°ä½ç½®ã€‚

åŸºäºå¯¹ä»£ç çš„æ·±å…¥åˆ†æï¼Œæˆ‘æ‰¾åˆ°äº†**Smart Auto-Taggingï¼ˆæ™ºèƒ½è‡ªåŠ¨æ ‡ç­¾ï¼‰**åŠŸèƒ½çš„å…·ä½“ä½“ç°ä½ç½®ï¼š

#### 1. åŠŸèƒ½æ¦‚è¿°ä½ç½®

**æ–‡æ¡£æè¿°**ï¼š`/workspace/features-guide.md` ç¬¬180-183è¡Œ
```markdown
- **ğŸ¯ Smart Auto-Tagging**
  - AI automatic entity domain identification (medical, technology, culture, education, etc.)
  - LLM-based semantic understanding annotation
  - Batch annotation processing support
```

#### 2. å‰ç«¯ç•Œé¢å®ç°

##### A. é¡µé¢æ¨¡æ¿
**ä½ç½®**ï¼š`/workspace/KnowledgeGraphConstruction/templates/domain_tags.html`

**æ ¸å¿ƒåŠŸèƒ½ç•Œé¢**ï¼š
- ğŸ¤– **æ‰¹é‡æ£€æµ‹æŒ‰é’®**ï¼ˆç¬¬46è¡Œï¼‰ï¼š`å¼€å§‹æ‰¹é‡æ£€æµ‹`
- ğŸ“Š **æ ‡ç­¾ç»Ÿè®¡ä¿¡æ¯**ï¼ˆç¬¬77-89è¡Œï¼‰ï¼šæ˜¾ç¤ºæ£€æµ‹åˆ°çš„é¢†åŸŸæ ‡ç­¾ç»Ÿè®¡
- ğŸ·ï¸ **æ ‡ç­¾ç­›é€‰åŠŸèƒ½**ï¼ˆç¬¬92-110è¡Œï¼‰ï¼šæ”¯æŒå¤šæ ‡ç­¾ç­›é€‰å’Œæ•°æ®è¿‡æ»¤

##### B. JavaScriptå®ç°
**ä½ç½®**ï¼š`/workspace/KnowledgeGraphConstruction/static/js/domain_tags.js`

**å…³é”®æ–¹æ³•**ï¼š
- `detectFolderDomainTags()` (ç¬¬147è¡Œ)ï¼šæ–‡ä»¶å¤¹æ‰¹é‡æ™ºèƒ½æ ‡ç­¾æ£€æµ‹
- `detectSingleFiles()` (ç¬¬454è¡Œ)ï¼šå•æ–‡ä»¶æ™ºèƒ½æ ‡ç­¾æ£€æµ‹
- `displayTagsInfo()` (ç¬¬286è¡Œ)ï¼šæ ‡ç­¾ä¿¡æ¯å¯è§†åŒ–å±•ç¤º

#### 3. åç«¯APIå®ç°

##### A. ä¸»è¦APIç«¯ç‚¹
**ä½ç½®**ï¼š`/workspace/KnowledgeGraphConstruction/web_app.py`

**æ ¸å¿ƒAPIï¼š**
```python
@app.route('/api/data_management/detect_folder_domain_tags', methods=['POST'])  # ç¬¬2951è¡Œ
def detect_folder_domain_tags():
    """æ£€æµ‹æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰JSONLæ–‡ä»¶çš„é¢†åŸŸæ ‡ç­¾"""
```

**æ”¯æŒAPIï¼š**
```python
@app.route('/api/data_management/get_domain_tags_info', methods=['GET'])  # ç¬¬2987è¡Œ
def get_domain_tags_info():
    """è·å–é¢†åŸŸæ ‡ç­¾ä¿¡æ¯"""
```

##### B. æ ¸å¿ƒå¤„ç†å‡½æ•°
**ä½ç½®**ï¼š`/workspace/KnowledgeGraphConstruction/web_app.py` ç¬¬3116è¡Œ
```python
def process_folder_domain_detection(folder_path, llm_client, force_reprocess=False):
    """å¤„ç†æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰JSONLæ–‡ä»¶çš„é¢†åŸŸæ ‡ç­¾æ£€æµ‹"""
```

#### 4. æ™ºèƒ½æ ‡ç­¾Schemaå®šä¹‰

##### A. é¢„å®šä¹‰é¢†åŸŸæ ‡ç­¾
**ä½ç½®**ï¼š`/workspace/KnowledgeGraphConstruction/web_app.py` ç¬¬23è¡Œ
```python
PREDEFINED_DOMAIN_TAGS = {'ä½“è‚²', 'å­¦æœ¯', 'æ”¿æ²»', 'å¨±ä¹', 'æ–‡å­¦', 'æ–‡åŒ–', 'ç»æµ', 'ç§‘æŠ€', 'å†å²', 'åŒ»ç–—', 'å…¶ä»–'}
```

##### B. æ ‡ç­¾åˆ†ç±»è§„åˆ™
**ä½ç½®**ï¼š`/workspace/KnowledgeGraphConstruction/web_app.py` ç¬¬3654-3677è¡Œ

**è¯¦ç»†å®šä¹‰**ï¼š
```python
"å¯é€‰æ ‡ç­¾ï¼š",
"- ä½“è‚²ï¼šè¿åŠ¨ç«æŠ€ã€ä½“è‚²èµ›äº‹ã€å¥èº«é”»ç‚¼",
"- å­¦æœ¯ï¼šç§‘å­¦ç ”ç©¶ã€å­¦æœ¯ç†è®ºã€æ•™è‚²çŸ¥è¯†", 
"- æ”¿æ²»ï¼šæ”¿åºœæ”¿ç­–ã€æ”¿æ²»åˆ¶åº¦ã€å›½é™…å…³ç³»",
"- å¨±ä¹ï¼šå½±è§†éŸ³ä¹ã€æ¸¸æˆå¨±ä¹ã€æ˜æ˜Ÿå…«å¦",
"- æ–‡å­¦ï¼šæ–‡å­¦ä½œå“ã€è¯—æ­Œæ•£æ–‡ã€æ–‡å­¦åˆ›ä½œ",
"- æ–‡åŒ–ï¼šä¼ ç»Ÿæ–‡åŒ–ã€è‰ºæœ¯æ–‡åŒ–ã€ç¤¾ä¼šæ–‡åŒ–",
"- ç»æµï¼šå•†ä¸šé‡‘èã€å¸‚åœºç»æµã€æŠ•èµ„ç†è´¢",
"- ç§‘æŠ€ï¼šè®¡ç®—æœºæŠ€æœ¯ã€äººå·¥æ™ºèƒ½ã€ç§‘æŠ€äº§å“",
"- å†å²ï¼šå†å²äº‹ä»¶ã€å†å²äººç‰©ã€å†å²ç ”ç©¶", 
"- åŒ»ç–—ï¼šåŒ»å­¦æ²»ç–—ã€å¥åº·å…»ç”Ÿã€ç–¾ç—…è¯Šæ–­",
"- å…¶ä»–ï¼šä¸å±äºä»¥ä¸Šä»»ä½•é¢†åŸŸçš„é—®é¢˜"
```

#### 5. LLMæ™ºèƒ½è¯†åˆ«Prompt

##### A. æ ¸å¿ƒPromptæ¨¡æ¿
**ä½ç½®**ï¼š`/workspace/KnowledgeGraphConstruction/web_app.py` ç¬¬3648-3703è¡Œ

**æ™ºèƒ½åˆ†æè§„åˆ™**ï¼š
```python
"åˆ†ç±»è§„åˆ™ï¼š",
"1. å¤šé¢†åŸŸç›¸å…³æ—¶ï¼šé€‰æ‹©é—®é¢˜æ ¸å¿ƒå†…å®¹å’Œä¸»è¦ç›®çš„æœ€ç›¸å…³çš„é¢†åŸŸ",
"2. ç›¸å…³æ€§åˆ¤æ–­ï¼šåªæœ‰å½“é—®é¢˜ä¸æŸä¸ªé¢†åŸŸæœ‰æ˜ç¡®ã€ç›´æ¥çš„å…³è”æ—¶æ‰é€‰æ‹©è¯¥é¢†åŸŸ", 
"3. é¿å…å¼ºè¡Œå½’ç±»ï¼šå¦‚æœé—®é¢˜ä¸æ‰€æœ‰é¢„å®šä¹‰é¢†åŸŸçš„ç›¸å…³æ€§éƒ½å¾ˆå¼±ï¼Œæœæ–­é€‰æ‹©'å…¶ä»–'",
"4. ä¼˜å…ˆçº§åˆ¤æ–­ï¼šé—®é¢˜çš„ä¸»è¦è®¨è®ºç„¦ç‚¹ > èƒŒæ™¯ä¿¡æ¯ > é™„å¸¦æåŠçš„å†…å®¹"
```

##### B. æ™ºèƒ½ç¤ºä¾‹
```python
"ç¤ºä¾‹ï¼š",
"- 'NBAçƒå‘˜çš„è¥å…»é¥®é£Ÿå»ºè®®' â†’ ä½“è‚²ï¼ˆæ ¸å¿ƒæ˜¯ä½“è‚²ç›¸å…³çš„é¥®é£Ÿï¼Œè€Œéä¸€èˆ¬åŒ»ç–—ï¼‰",
"- 'å¦‚ä½•ç”¨Pythonåˆ†æè‚¡ç¥¨æ•°æ®' â†’ ç§‘æŠ€ï¼ˆæ ¸å¿ƒæ˜¯ç¼–ç¨‹æŠ€æœ¯ï¼Œè€Œéé‡‘èåˆ†æï¼‰", 
"- 'æ˜æ˜Ÿåœ¨ç”µå½±ä¸­çš„å†å²æœè£…' â†’ å¨±ä¹ï¼ˆæ ¸å¿ƒæ˜¯å½±è§†å†…å®¹ï¼Œå†å²åªæ˜¯èƒŒæ™¯ï¼‰",
"- 'ä»Šå¤©å¤©æ°”çœŸå¥½' â†’ å…¶ä»–ï¼ˆä¸æ‰€æœ‰é¢†åŸŸç›¸å…³æ€§éƒ½å¾ˆå¼±ï¼‰"
```

#### 6. æ‰¹é‡å¤„ç†æ¶æ„

##### A. æ™ºèƒ½åˆ†æ‰¹ç­–ç•¥
**ä½ç½®**ï¼š`/workspace/KnowledgeGraphConstruction/web_app.py` ç¬¬3562è¡Œ
```python
max_chars_per_batch = 70000  # æ¯æ‰¹æœ€å¤§å­—ç¬¦æ•°
```

##### B. æ ‡ç­¾ç®¡ç†å™¨
**ä½ç½®**ï¼š`/workspace/KnowledgeGraphConstruction/web_app.py` ç¬¬3124è¡Œ
```python
tag_manager = DomainTagManager(folder_path)
```

#### 7. å®Œæ•´å·¥ä½œæµç¨‹

Smart Auto-Taggingçš„å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š

1. **æ•°æ®è¾“å…¥** â†’ ç”¨æˆ·é€‰æ‹©æ–‡ä»¶å¤¹æˆ–å•ä¸ªJSONLæ–‡ä»¶
2. **æ™ºèƒ½åˆ†æ** â†’ LLMåŸºäºé—®é¢˜å†…å®¹å’Œæ¨ç†è·¯å¾„è¿›è¡Œè¯­ä¹‰ç†è§£
3. **é¢†åŸŸè¯†åˆ«** â†’ æ ¹æ®é¢„å®šä¹‰çš„11ä¸ªé¢†åŸŸæ ‡ç­¾è¿›è¡Œæ™ºèƒ½åˆ†ç±»
4. **æ‰¹é‡å¤„ç†** â†’ è‡ªåŠ¨æŒ‰å­—ç¬¦æ•°åˆ†æ‰¹ï¼Œé¿å…APIé™åˆ¶
5. **ç»“æœä¿å­˜** â†’ ç”Ÿæˆå¸¦æ ‡ç­¾çš„æ–°æ–‡ä»¶åˆ°`tagged/`å­ç›®å½•
6. **å¯è§†åŒ–å±•ç¤º** â†’ æä¾›æ ‡ç­¾ç»Ÿè®¡ã€ç­›é€‰ã€åˆ†é¡µç­‰åŠŸèƒ½
7. **è´¨é‡æ§åˆ¶** â†’ æ”¯æŒå¼ºåˆ¶é‡æ–°å¤„ç†å’Œæ ‡ç­¾éªŒè¯

#### æ€»ç»“

Smart Auto-Taggingæ˜¯è¿™ä¸ªé¡¹ç›®çš„ä¸€ä¸ªé‡è¦åˆ›æ–°åŠŸèƒ½ï¼Œå®ƒé€šè¿‡**LLMè¯­ä¹‰ç†è§£ + é¢„å®šä¹‰æ ‡ç­¾ä½“ç³» + æ™ºèƒ½åˆ†ç±»è§„åˆ™**ï¼Œå®ç°äº†å¯¹QAæ•°æ®çš„è‡ªåŠ¨é¢†åŸŸåˆ†ç±»ï¼Œå¤§å¤§æé«˜äº†æ•°æ®ç®¡ç†å’Œç»„ç»‡çš„æ•ˆç‡ã€‚æ•´ä¸ªåŠŸèƒ½ä»å‰ç«¯ç•Œé¢åˆ°åç«¯å¤„ç†éƒ½æœ‰å®Œæ•´çš„å®ç°ï¼Œä½“ç°äº†ç°ä»£AIåº”ç”¨çš„æ™ºèƒ½åŒ–ç‰¹å¾ã€‚

---

### ç”¨æˆ·æŸ¥è¯¢3ï¼š4. Wikidataå®ä½“é“¾æ¥Schema ä½ç½®ï¼š /workspace/KnowledgeGraphConstruction/lib/entity_linker.py è¿™ä¸ªwikidata å®ä½“é“¾æ¥ï¼Œæ˜¯åœ¨llm_extractä¹‹åè¿˜æ˜¯ä¹‹å‰

è®©æˆ‘åˆ†æä¸€ä¸‹Wikidataå®ä½“é“¾æ¥åœ¨æ•´ä¸ªçŸ¥è¯†å›¾è°±æ„å»ºæµç¨‹ä¸­çš„å…·ä½“ä½ç½®ï¼Œç‰¹åˆ«æ˜¯å®ƒä¸LLMå®ä½“æŠ½å–çš„æ—¶åºå…³ç³»ã€‚

åŸºäºå¯¹ä»£ç çš„è¯¦ç»†åˆ†æï¼Œæˆ‘å¯ä»¥æ˜ç¡®å›ç­”**Wikidataå®ä½“é“¾æ¥åœ¨æ•´ä¸ªæµç¨‹ä¸­çš„ä½ç½®**ï¼š

#### å½“å‰çŠ¶æ€ï¼šå®ä½“é“¾æ¥åŠŸèƒ½è¢«ç¦ç”¨

##### 1. åŠŸèƒ½çŠ¶æ€åˆ†æ

**å½“å‰å®é™…çŠ¶æ€**ï¼šWikidataå®ä½“é“¾æ¥åŠŸèƒ½**å·²è¢«æ³¨é‡Šæ‰**ï¼Œç›®å‰**ä¸åœ¨ä½¿ç”¨ä¸­**ã€‚

**è¯æ®ä½ç½®**ï¼š
- `/workspace/KnowledgeGraphConstruction/lib/graphrag_builder.py` ç¬¬1738-1798è¡Œ
- æ‰€æœ‰ä¸EntityLinkerç›¸å…³çš„ä»£ç éƒ½è¢«æ³¨é‡Šæ‰äº†

##### 2. åŸè®¾è®¡çš„æ—¶åºå…³ç³»

æ ¹æ®è¢«æ³¨é‡Šçš„ä»£ç åˆ†æï¼ŒWikidataå®ä½“é“¾æ¥**åŸæœ¬è®¾è®¡æ˜¯åœ¨LLMå®ä½“æŠ½å–ä¹‹å**è¿›è¡Œçš„ï¼š

**å®Œæ•´çš„åŸè®¾è®¡æµç¨‹ï¼š**

```python
async def _extract_entities_with_llm(self, text: str, current_entity: str = None):
    """ä½¿ç”¨LLMä»æ–‡æœ¬ä¸­æŠ½å–å®ä½“å’Œå…³ç³»ï¼Œå¹¶è¿›è¡ŒWikidataå®ä½“é“¾æ¥"""
    
    # æ­¥éª¤1: æ–‡æœ¬é¢„ç­›é€‰
    filtered_text = await self._prefilter_text_with_llm(text, current_entity)
    
    # æ­¥éª¤2: LLMå®ä½“å…³ç³»æŠ½å–
    response = await self.llm_client.generate_response(prompt)
    data = json.loads(clean_response)
    raw_entities = data.get('entities', [])  # LLMæŠ½å–çš„åŸå§‹å®ä½“
    relationships = data.get('relationships', [])
    
    # æ­¥éª¤3: ã€è¿™é‡Œæ˜¯Wikidataå®ä½“é“¾æ¥çš„ä½ç½®ã€‘
    # ğŸ”— å¯¹LLMæŠ½å–çš„å®ä½“è¿›è¡ŒWikidataæ ‡å‡†åŒ–
    # if raw_entities:
    #     async with EntityLinker() as linker:
    #         linking_results = await linker.link_entities_batch(raw_entities, language="zh")
    
    # æ­¥éª¤4: å®ä½“æ ‡å‡†åŒ–å’Œå…³ç³»æ›´æ–°
    # ä½¿ç”¨Wikidataæ ‡å‡†åŒ–çš„å®ä½“åç§°æ›´æ–°å…³ç³»
    
    return raw_entities, relationships
```

##### 3. è¯¦ç»†çš„æ—¶åºè®¾è®¡

###### A. **LLMå®ä½“æŠ½å–** (ç¬¬1562-1627è¡Œ)
```python
# 1. LLMä»æ–‡æœ¬ä¸­æŠ½å–åŸå§‹å®ä½“å’Œå…³ç³»
response = await self.llm_client.generate_response(prompt)
data = json.loads(clean_response)
raw_entities = data.get('entities', [])  # åŸå§‹å®ä½“åˆ—è¡¨
relationships = data.get('relationships', [])
```

###### B. **Wikidataå®ä½“é“¾æ¥** (ç¬¬1738-1745è¡Œ - å·²æ³¨é‡Š)
```python
# 2. å¯¹LLMæŠ½å–çš„å®ä½“è¿›è¡ŒWikidataé“¾æ¥
# async with EntityLinker() as linker:
#     linking_results = await linker.link_entities_batch(raw_entities, language="zh")
```

###### C. **å®ä½“æ ‡å‡†åŒ–æ˜ å°„** (ç¬¬1747-1767è¡Œ - å·²æ³¨é‡Š)
```python
# 3. åˆ›å»ºåŸå§‹å®ä½“åˆ°æ ‡å‡†åŒ–å®ä½“çš„æ˜ å°„
# for raw_entity in raw_entities:
#     linking_result = linking_results.get(raw_entity, {})
#     if linking_result.get('success', False):
#         standard_name = linking_result.get('standard_name', raw_entity)
#         standardized_entities.append(standard_name)
```

###### D. **å…³ç³»æ›´æ–°** (ç¬¬1769-1784è¡Œ - å·²æ³¨é‡Š)
```python
# 4. ä½¿ç”¨æ ‡å‡†åŒ–çš„å®ä½“åç§°æ›´æ–°å…³ç³»
# for relation in relationships:
#     if relation['source'] in entity_mapping:
#         relation['source'] = entity_mapping[relation['source']]
#         relation['source_linked'] = True
```

##### 4. Wikidataå®ä½“é“¾æ¥Schemaå›é¡¾

**ä½ç½®**ï¼š`/workspace/KnowledgeGraphConstruction/lib/entity_linker.py` ç¬¬41-49è¡Œ

```python
{
    'success': bool,                    # é“¾æ¥æ˜¯å¦æˆåŠŸ
    'standard_name': str,              # æ ‡å‡†åŒ–çš„å®ä½“åç§°
    'wikidata_id': str,               # Wikidata ID (Qå¼€å¤´)
    'description': str,               # å®ä½“æè¿°
    'aliases': List[str],             # åˆ«ååˆ—è¡¨
    'properties': Dict[str, List[str]], # é‡è¦å±æ€§
    'url': str,                       # Wikidataé¡µé¢é“¾æ¥
    'confidence': float               # åŒ¹é…ç½®ä¿¡åº¦
}
```

#### æ€»ç»“

**å›ç­”ä½ çš„é—®é¢˜**ï¼šWikidataå®ä½“é“¾æ¥åŸæœ¬è®¾è®¡æ˜¯åœ¨**LLMå®ä½“æŠ½å–ä¹‹å**è¿›è¡Œçš„ï¼Œå…·ä½“æ—¶åºå¦‚ä¸‹ï¼š

1. **LLMå®ä½“æŠ½å–** â†’ è·å¾—åŸå§‹å®ä½“åˆ—è¡¨
2. **Wikidataå®ä½“é“¾æ¥** â†’ å¯¹åŸå§‹å®ä½“è¿›è¡Œæ ‡å‡†åŒ– (ç›®å‰å·²ç¦ç”¨)
3. **å®ä½“æ˜ å°„æ›´æ–°** â†’ ç”¨æ ‡å‡†åŒ–åç§°æ›´æ–°å…³ç³» (ç›®å‰å·²ç¦ç”¨)
4. **è¿”å›ç»“æœ** â†’ è¿”å›å¤„ç†åçš„å®ä½“å’Œå…³ç³»

**å½“å‰çŠ¶æ€**ï¼šæ•´ä¸ªWikidataå®ä½“é“¾æ¥åŠŸèƒ½éƒ½è¢«æ³¨é‡Šæ‰äº†ï¼Œç³»ç»Ÿç›®å‰ç›´æ¥ä½¿ç”¨LLMæŠ½å–çš„åŸå§‹å®ä½“åç§°ï¼Œæ²¡æœ‰è¿›è¡ŒWikidataæ ‡å‡†åŒ–ã€‚è¿™å¯èƒ½æ˜¯ä¸ºäº†æé«˜å¤„ç†é€Ÿåº¦æˆ–é¿å…å¤–éƒ¨APIä¾èµ–è€Œåšçš„æƒè¡¡ã€‚

å¦‚æœéœ€è¦é‡æ–°å¯ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œåªéœ€è¦å–æ¶ˆç›¸å…³ä»£ç çš„æ³¨é‡Šå³å¯æ¢å¤å®Œæ•´çš„"LLMæŠ½å– â†’ Wikidataé“¾æ¥ â†’ å®ä½“æ ‡å‡†åŒ–"æµç¨‹ã€‚

---

### ç”¨æˆ·æŸ¥è¯¢4ï¼šæˆ‘ä»¬å†å›å»çœ‹ä¸‹è¿™ä¸ªSmart Auto-Taggingçš„å·¥ä½œæµç¨‹ ï¼Œè¿™ä¸ªå·¥ä½œæµç¨‹æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„

è®©æˆ‘é‡æ–°æ·±å…¥åˆ†æSmart Auto-Taggingçš„å·¥ä½œæµç¨‹ï¼Œç†è§£å®ƒåœ¨æ•´ä¸ªç³»ç»Ÿä¸­çš„å…·ä½“ä½œç”¨å’Œç›®çš„ã€‚

åŸºäºæ·±å…¥åˆ†æï¼Œæˆ‘ç°åœ¨å¯ä»¥æ¸…æ¥šåœ°è§£é‡Š**Smart Auto-Taggingçš„å·¥ä½œæµç¨‹æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„**ï¼š

#### Smart Auto-Taggingçš„æ ¸å¿ƒç›®çš„

##### 1. **QAæ•°æ®é›†çš„æ™ºèƒ½åˆ†ç±»ç®¡ç†**

Smart Auto-Taggingçš„ä¸»è¦ä½œç”¨æ˜¯**å¯¹çŸ¥è¯†å›¾è°±ç”Ÿæˆçš„QAæ•°æ®è¿›è¡Œè‡ªåŠ¨é¢†åŸŸåˆ†ç±»**ï¼Œå…·ä½“ç›®çš„åŒ…æ‹¬ï¼š

###### A. **æ•°æ®ç»„ç»‡å’Œç®¡ç†**
- **è¾“å…¥**ï¼šçŸ¥è¯†å›¾è°±æ„å»ºç³»ç»Ÿç”Ÿæˆçš„QAå¯¹æ•°æ®ï¼ˆåŒ…å«question, answer, reasoning_pathç­‰ï¼‰
- **å¤„ç†**ï¼šä½¿ç”¨LLMåˆ†æé—®é¢˜å†…å®¹å’Œæ¨ç†è·¯å¾„ï¼Œè‡ªåŠ¨è¯†åˆ«é¢†åŸŸå½’å±
- **è¾“å‡º**ï¼šå¸¦æœ‰domain_tagsæ ‡ç­¾çš„ç»“æ„åŒ–QAæ•°æ®

###### B. **å®é™…å¤„ç†çš„æ•°æ®ç¤ºä¾‹**
```json
// åŸå§‹QAæ•°æ®
{
  "question": "ä¸€ä¸ªåœ¨2021å¹´8æœˆè¿›è¡Œè¿‡äººå£ç»Ÿè®¡...è¿™ç§æ„ŸæŸ“ç—…æœ€å¸¸è§çš„ç»†èŒæ€§ç—…å› æ˜¯ä»€ä¹ˆï¼Ÿ",
  "answer": "è‚ºç‚é“¾çƒèŒ",
  "reasoning_path": "1. ç¬¬ä¸€æ­¥ï¼šè¯†åˆ«å…³é”®åœ°ç‚¹å®ä½“...",
  "source_entity": "è‚ºç‚"
}

// Smart Auto-Taggingå¤„ç†å
{
  "question": "...",
  "answer": "è‚ºç‚é“¾çƒèŒ", 
  "reasoning_path": "...",
  "source_entity": "è‚ºç‚",
  "domain_tags": ["åŒ»ç–—"]  // ğŸ¯ æ–°å¢çš„æ™ºèƒ½æ ‡ç­¾
}
```

##### 2. **æ”¯æŒçš„ä¸šåŠ¡åœºæ™¯**

###### A. **æ•°æ®é›†ä¸“ä¸šåŒ–åˆ†ç±»**
- **åŒ»ç–—é¢†åŸŸ**ï¼šç­›é€‰å‡ºæ‰€æœ‰åŒ»å­¦ç›¸å…³çš„QAå¯¹ï¼Œç”¨äºåŒ»ç–—AIè®­ç»ƒ
- **ç§‘æŠ€é¢†åŸŸ**ï¼šæå–æŠ€æœ¯ç›¸å…³é—®é¢˜ï¼Œç”¨äºæŠ€æœ¯é—®ç­”ç³»ç»Ÿ
- **æ•™è‚²é¢†åŸŸ**ï¼šæŒ‰å­¦ç§‘åˆ†ç±»æ•´ç†æ•™è‚²èµ„æº

###### B. **è´¨é‡æ§åˆ¶å’Œè¯„ä¼°**
- **é¢†åŸŸä¸€è‡´æ€§æ£€æŸ¥**ï¼šç¡®ä¿åŒä¸€é¢†åŸŸçš„QAè´¨é‡æ ‡å‡†
- **æ•°æ®å¹³è¡¡æ€§åˆ†æ**ï¼šç»Ÿè®¡å„é¢†åŸŸæ•°æ®åˆ†å¸ƒï¼Œé¿å…åæ–œ
- **ä¸“ä¸šæ€§éªŒè¯**ï¼šè¯†åˆ«è·¨é¢†åŸŸæˆ–é¢†åŸŸä¸æ˜ç¡®çš„é—®é¢˜

###### C. **ç”Ÿäº§éƒ¨ç½²ä¼˜åŒ–**
- **æŒ‰éœ€ç­›é€‰**ï¼šæ ¹æ®åº”ç”¨åœºæ™¯ç­›é€‰ç‰¹å®šé¢†åŸŸæ•°æ®
- **æ‰¹é‡å¤„ç†**ï¼šæ”¯æŒå¤§è§„æ¨¡æ•°æ®é›†çš„è‡ªåŠ¨åŒ–æ ‡ç­¾å¤„ç†
- **ç‰ˆæœ¬ç®¡ç†**ï¼šä¸ºä¸åŒç‰ˆæœ¬çš„æ•°æ®é›†æä¾›æ ‡ç­¾åŒ–ç®¡ç†

##### 3. **å®Œæ•´çš„æ•°æ®æµæ°´çº¿ä½œç”¨**

```
çŸ¥è¯†å›¾è°±æ„å»º â†’ QAç”Ÿæˆ â†’ Smart Auto-Tagging â†’ æ•°æ®ç®¡ç† â†’ æœ€ç»ˆå‘å¸ƒ
     â†“              â†“           â†“              â†“           â†“
   å®ä½“å…³ç³»        é—®ç­”å¯¹      é¢†åŸŸæ ‡ç­¾        è´¨é‡æ§åˆ¶     ç”Ÿäº§æ•°æ®
```

###### A. **åœ¨æµæ°´çº¿ä¸­çš„ä½ç½®**
Smart Auto-Taggingä½äº**QAæ•°æ®ç”Ÿæˆä¹‹åï¼Œæ•°æ®ç®¡ç†å’Œå‘å¸ƒä¹‹å‰**ï¼Œèµ·åˆ°**æ•°æ®å¢å¼ºå’Œç»„ç»‡**çš„ä½œç”¨ã€‚

###### B. **ä¸å…¶ä»–æ¨¡å—çš„ååŒ**
- **æ•°æ®ç®¡ç†é¡µé¢**ï¼šä½¿ç”¨æ ‡ç­¾è¿›è¡Œæ•°æ®ç­›é€‰ã€æœç´¢å’Œé¢„è§ˆ
- **æœ€ç»ˆæ•°æ®é›†é¡µé¢**ï¼šåŸºäºæ ‡ç­¾è¿›è¡Œå¤šç»´åº¦è¿‡æ»¤å’Œå¯¼å‡º
- **è´¨é‡è¯„ä¼°**ï¼šæŒ‰é¢†åŸŸè¿›è¡Œä¸“ä¸šåŒ–è´¨é‡è¯„ä¼°

##### 4. **æ™ºèƒ½åŒ–çš„æ ¸å¿ƒä»·å€¼**

###### A. **è‡ªåŠ¨åŒ–ç¨‹åº¦é«˜**
- **æ‰¹é‡å¤„ç†**ï¼šä¸€æ¬¡å¤„ç†æ•´ä¸ªæ–‡ä»¶å¤¹çš„æ‰€æœ‰JSONLæ–‡ä»¶
- **æ™ºèƒ½åˆ†æ**ï¼šåŸºäºé—®é¢˜å†…å®¹å’Œæ¨ç†è·¯å¾„çš„è¯­ä¹‰ç†è§£
- **å¢é‡æ›´æ–°**ï¼šæ”¯æŒæ–°æ•°æ®çš„è‡ªåŠ¨æ ‡ç­¾åŒ–

###### B. **åˆ†ç±»è´¨é‡ä¿è¯**
- **é¢„å®šä¹‰æ ‡ç­¾ä½“ç³»**ï¼š11ä¸ªæ ‡å‡†é¢†åŸŸæ ‡ç­¾ï¼Œç¡®ä¿ä¸€è‡´æ€§
- **æ™ºèƒ½åˆ†ç±»è§„åˆ™**ï¼šå¤šå±‚æ¬¡åˆ¤æ–­é€»è¾‘ï¼Œé¿å…è¯¯åˆ†ç±»
- **è´¨é‡åé¦ˆæœºåˆ¶**ï¼šæ”¯æŒæ‰‹åŠ¨æ ¡æ­£å’Œå†å²è®°å½•

###### C. **ä¸šåŠ¡åº”ç”¨çµæ´»æ€§**
- **å¤šç»´åº¦ç­›é€‰**ï¼šæ”¯æŒæ ‡ç­¾ç»„åˆç­›é€‰
- **ç»Ÿè®¡åˆ†æ**ï¼šæä¾›é¢†åŸŸåˆ†å¸ƒç»Ÿè®¡å’Œå¯è§†åŒ–
- **å¯¼å‡ºå®šåˆ¶**ï¼šæŒ‰æ ‡ç­¾å¯¼å‡ºç‰¹å®šé¢†åŸŸæ•°æ®

#### æ€»ç»“

**Smart Auto-Taggingçš„å·¥ä½œæµç¨‹æ˜¯ç”¨æ¥å®ç°QAæ•°æ®é›†çš„æ™ºèƒ½åŒ–é¢†åŸŸåˆ†ç±»å’Œç®¡ç†**ã€‚å®ƒè§£å†³äº†å¤§è§„æ¨¡çŸ¥è¯†é—®ç­”æ•°æ®é›†åœ¨å®é™…åº”ç”¨ä¸­çš„**ç»„ç»‡ã€ç­›é€‰ã€è´¨æ§å’Œéƒ¨ç½²**é—®é¢˜ï¼Œé€šè¿‡AIè‡ªåŠ¨åŒ–çš„æ–¹å¼å°†åŸæœ¬éœ€è¦äººå·¥åˆ†ç±»çš„æµ·é‡QAæ•°æ®æŒ‰é¢†åŸŸè¿›è¡Œæ ‡å‡†åŒ–æ ‡æ³¨ï¼Œä¸ºåç»­çš„ä¸“ä¸šåŒ–åº”ç”¨ã€è´¨é‡æ§åˆ¶å’Œç”Ÿäº§éƒ¨ç½²æä¾›äº†é‡è¦çš„æ•°æ®åŸºç¡€è®¾æ–½æ”¯æŒã€‚

è¿™ä¸ªåŠŸèƒ½ç‰¹åˆ«é€‚ç”¨äºéœ€è¦**é¢†åŸŸä¸“ä¸šåŒ–**çš„AIåº”ç”¨åœºæ™¯ï¼Œå¦‚åŒ»ç–—é—®ç­”ç³»ç»Ÿã€æ•™è‚²å¹³å°ã€ä¸“ä¸šå’¨è¯¢ç³»ç»Ÿç­‰ï¼Œwhereæ•°æ®çš„é¢†åŸŸå‡†ç¡®æ€§ç›´æ¥å½±å“åº”ç”¨æ•ˆæœã€‚

---

### ç”¨æˆ·æŸ¥è¯¢5ï¼šSmart Auto-Taggingçš„æ ‡ç­¾æ¥è‡ªå“ªé‡Œ

è®©æˆ‘è¯¦ç»†åˆ†æSmart Auto-Taggingçš„æ ‡ç­¾æ¥æºå’Œå®šä¹‰ã€‚

åŸºäºè¯¦ç»†çš„ä»£ç åˆ†æï¼Œæˆ‘å¯ä»¥æ˜ç¡®å›ç­”**Smart Auto-Taggingçš„æ ‡ç­¾æ¥è‡ªå“ªé‡Œ**ï¼š

#### Smart Auto-Taggingæ ‡ç­¾çš„æ¥æº

##### 1. **ç¡¬ç¼–ç çš„é¢„å®šä¹‰æ ‡ç­¾ä½“ç³»**

æ ‡ç­¾æ¥æºäº**ç³»ç»Ÿå†…ç½®çš„é¢„å®šä¹‰æ ‡ç­¾é›†åˆ**ï¼Œå…·ä½“å®šä¹‰åœ¨ï¼š

**ä½ç½®**ï¼š`/workspace/KnowledgeGraphConstruction/web_app.py` ç¬¬23è¡Œ
```python
# é¢„å®šä¹‰çš„é¢†åŸŸæ ‡ç­¾åˆ—è¡¨
PREDEFINED_DOMAIN_TAGS = {'ä½“è‚²', 'å­¦æœ¯', 'æ”¿æ²»', 'å¨±ä¹', 'æ–‡å­¦', 'æ–‡åŒ–', 'ç»æµ', 'ç§‘æŠ€', 'å†å²', 'åŒ»ç–—', 'å…¶ä»–'}
```

##### 2. **å®Œæ•´çš„æ ‡ç­¾ä½“ç³»å®šä¹‰**

###### A. **11ä¸ªå›ºå®šé¢†åŸŸæ ‡ç­¾**
```python
{
    'ä½“è‚²': 'è¿åŠ¨ç«æŠ€ã€ä½“è‚²èµ›äº‹ã€å¥èº«é”»ç‚¼',
    'å­¦æœ¯': 'ç§‘å­¦ç ”ç©¶ã€å­¦æœ¯ç†è®ºã€æ•™è‚²çŸ¥è¯†', 
    'æ”¿æ²»': 'æ”¿åºœæ”¿ç­–ã€æ”¿æ²»åˆ¶åº¦ã€å›½é™…å…³ç³»',
    'å¨±ä¹': 'å½±è§†éŸ³ä¹ã€æ¸¸æˆå¨±ä¹ã€æ˜æ˜Ÿå…«å¦',
    'æ–‡å­¦': 'æ–‡å­¦ä½œå“ã€è¯—æ­Œæ•£æ–‡ã€æ–‡å­¦åˆ›ä½œ',
    'æ–‡åŒ–': 'ä¼ ç»Ÿæ–‡åŒ–ã€è‰ºæœ¯æ–‡åŒ–ã€ç¤¾ä¼šæ–‡åŒ–',
    'ç»æµ': 'å•†ä¸šé‡‘èã€å¸‚åœºç»æµã€æŠ•èµ„ç†è´¢',
    'ç§‘æŠ€': 'è®¡ç®—æœºæŠ€æœ¯ã€äººå·¥æ™ºèƒ½ã€ç§‘æŠ€äº§å“',
    'å†å²': 'å†å²äº‹ä»¶ã€å†å²äººç‰©ã€å†å²ç ”ç©¶',
    'åŒ»ç–—': 'åŒ»å­¦æ²»ç–—ã€å¥åº·å…»ç”Ÿã€ç–¾ç—…è¯Šæ–­',
    'å…¶ä»–': 'ä¸å±äºä»¥ä¸Šä»»ä½•é¢†åŸŸçš„é—®é¢˜'
}
```

###### B. **æ ‡ç­¾å®šä¹‰ä½ç½®**
**LLMæç¤ºè¯ä¸­çš„è¯¦ç»†å®šä¹‰**ï¼š`/workspace/KnowledgeGraphConstruction/web_app.py` ç¬¬3654-3665è¡Œ

##### 3. **æ ‡ç­¾ç®¡ç†æœºåˆ¶**

###### A. **æ ‡ç­¾åˆå§‹åŒ–**ï¼ˆç¬¬3443-3446è¡Œï¼‰
```python
# åˆå§‹åŒ–é¢„å®šä¹‰æ ‡ç­¾ï¼ˆç¡®ä¿æ‰€æœ‰é¢„å®šä¹‰æ ‡ç­¾éƒ½å­˜åœ¨ï¼Œå³ä½¿è®¡æ•°ä¸º0ï¼‰
predefined_tags = {'ä½“è‚²', 'å­¦æœ¯', 'æ”¿æ²»', 'å¨±ä¹', 'æ–‡å­¦', 'æ–‡åŒ–', 'ç»æµ', 'ç§‘æŠ€', 'å†å²', 'åŒ»ç–—', 'å…¶ä»–'}
for tag in predefined_tags:
    self.add_tag(tag)
```

###### B. **æ ‡ç­¾éªŒè¯æœºåˆ¶**ï¼ˆç¬¬3728-3747è¡Œï¼‰
```python
# ä½¿ç”¨é¢„å®šä¹‰çš„æ ‡ç­¾åˆ—è¡¨
valid_tags = PREDEFINED_DOMAIN_TAGS

# éªŒè¯æ ‡ç­¾æ˜¯å¦åœ¨é¢„å®šä¹‰åˆ—è¡¨ä¸­
if clean_tag in valid_tags:
    selected_tag = clean_tag
    break  # æ‰¾åˆ°ç¬¬ä¸€ä¸ªæœ‰æ•ˆæ ‡ç­¾å°±åœæ­¢
else:
    # å¦‚æœæ ‡ç­¾ä¸åœ¨é¢„å®šä¹‰åˆ—è¡¨ä¸­ï¼Œè®°å½•æ—¥å¿—
    logger.warning(f"æ£€æµ‹åˆ°æœªé¢„å®šä¹‰æ ‡ç­¾ '{clean_tag}'ï¼Œå°†å¯»æ‰¾å…¶ä»–æœ‰æ•ˆæ ‡ç­¾æˆ–ä½¿ç”¨'å…¶ä»–'")
```

###### C. **æ ‡ç­¾æ¸…ç†æœºåˆ¶**ï¼ˆç¬¬3514-3527è¡Œï¼‰
```python
# æ¸…ç†ä¸å†ä½¿ç”¨çš„æ ‡ç­¾ï¼ˆä¸åœ¨é¢„å®šä¹‰åˆ—è¡¨ä¸­çš„æ ‡ç­¾ï¼‰
tags_to_remove = []
for tag_name in self.info['tags']:
    if tag_name not in predefined_tags:
        tags_to_remove.append(tag_name)

if tags_to_remove:
    logger.info(f"æ¸…ç†éé¢„å®šä¹‰æ ‡ç­¾: {tags_to_remove}")
    for tag_name in tags_to_remove:
        del self.info['tags'][tag_name]
```

##### 4. **æ ‡ç­¾å­˜å‚¨å’Œç®¡ç†**

###### A. **å­˜å‚¨æ ¼å¼**
æ ‡ç­¾ä¿¡æ¯å­˜å‚¨åœ¨ `domain_tags_info.json` æ–‡ä»¶ä¸­ï¼š
```json
{
  "tags": {
    "åŒ»ç–—": {"count": 1, "description": ""},
    "ä½“è‚²": {"count": 0, "description": ""},
    "å­¦æœ¯": {"count": 0, "description": ""},
    // ... å…¶ä»–é¢„å®šä¹‰æ ‡ç­¾
  },
  "total_processed": 1,
  "last_updated": "2025-08-19T21:25:30.028494"
}
```

###### B. **DomainTagManagerç±»ç®¡ç†**ï¼ˆç¬¬3266è¡Œå¼€å§‹ï¼‰
- **æ ‡ç­¾æ·»åŠ **ï¼š`add_tag()` æ–¹æ³•
- **è®¡æ•°æ›´æ–°**ï¼š`update_tag_count()` æ–¹æ³•
- **æ ‡ç­¾è·å–**ï¼š`get_all_tags()` æ–¹æ³•
- **ä¿¡æ¯ä¿å­˜**ï¼š`save_info()` æ–¹æ³•

##### 5. **æ ‡ç­¾çº¦æŸå’Œç‰¹ç‚¹**

###### A. **ä¸¥æ ¼çš„æ ‡ç­¾æ§åˆ¶**
- **åªèƒ½ä½¿ç”¨é¢„å®šä¹‰æ ‡ç­¾**ï¼šç³»ç»Ÿä¸å…è®¸åˆ›å»ºæ–°æ ‡ç­¾
- **å•æ ‡ç­¾æ¨¡å¼**ï¼šæ¯ä¸ªQAå¯¹åªèƒ½åˆ†é…ä¸€ä¸ªæ ‡ç­¾
- **å›é€€æœºåˆ¶**ï¼šæ— æ³•åˆ†ç±»æ—¶è‡ªåŠ¨ä½¿ç”¨"å…¶ä»–"æ ‡ç­¾

###### B. **LLMæç¤ºè¯çº¦æŸ**ï¼ˆç¬¬3696-3701è¡Œï¼‰
```python
"é‡è¦æé†’ï¼š
- åªèƒ½ä½¿ç”¨ä»¥ä¸Šåˆ—å‡ºçš„11ä¸ªæ ‡ç­¾ï¼šä½“è‚²ã€å­¦æœ¯ã€æ”¿æ²»ã€å¨±ä¹ã€æ–‡å­¦ã€æ–‡åŒ–ã€ç»æµã€ç§‘æŠ€ã€å†å²ã€åŒ»ç–—ã€å…¶ä»–
- æ¯ä¸ªé—®é¢˜åªèƒ½é€‰æ‹©ä¸€ä¸ªæœ€ç¬¦åˆçš„æ ‡ç­¾
- å¤šé¢†åŸŸäº¤å‰æ—¶ï¼Œé€‰æ‹©é—®é¢˜æ ¸å¿ƒå†…å®¹æœ€ç›¸å…³çš„é‚£ä¸ªé¢†åŸŸ
- ç›¸å…³æ€§ä¸è¶³æ—¶ï¼Œå®å¯é€‰æ‹©"å…¶ä»–"ä¹Ÿä¸è¦å¼ºè¡Œå½’ç±»åˆ°ä¸å¤ªç›¸å…³çš„é¢†åŸŸ
- å¿…é¡»ä»é¢„å®šä¹‰åˆ—è¡¨ä¸­é€‰æ‹©ï¼Œåªè¿”å›ä¸­æ–‡æ ‡ç­¾åç§°"
```

#### æ€»ç»“

**Smart Auto-Taggingçš„æ ‡ç­¾æ¥æºæ˜¯ç³»ç»Ÿå†…ç½®çš„é¢„å®šä¹‰æ ‡ç­¾ä½“ç³»**ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

1. **å›ºå®šæ€§**ï¼š11ä¸ªæ ‡ç­¾æ˜¯ç¡¬ç¼–ç åœ¨ç³»ç»Ÿä¸­çš„ï¼Œä¸å¯åŠ¨æ€ä¿®æ”¹
2. **å®Œæ•´æ€§**ï¼šè¦†ç›–äº†ä¸»è¦çš„çŸ¥è¯†é¢†åŸŸï¼ŒåŒ…å«å…œåº•çš„"å…¶ä»–"æ ‡ç­¾
3. **ä¸€è‡´æ€§**ï¼šé€šè¿‡ä¸¥æ ¼çš„éªŒè¯å’Œæ¸…ç†æœºåˆ¶ç¡®ä¿æ ‡ç­¾çš„æ ‡å‡†åŒ–
4. **ä¸“ä¸šæ€§**ï¼šæ¯ä¸ªæ ‡ç­¾éƒ½æœ‰æ˜ç¡®çš„é¢†åŸŸå®šä¹‰å’Œé€‚ç”¨èŒƒå›´

è¿™ç§è®¾è®¡ç¡®ä¿äº†æ ‡ç­¾ä½“ç³»çš„**ç¨³å®šæ€§å’Œä¸€è‡´æ€§**ï¼Œé¿å…äº†è‡ªç”±æ ‡ç­¾å¯èƒ½å¸¦æ¥çš„æ··ä¹±å’Œä¸ä¸€è‡´é—®é¢˜ï¼Œç‰¹åˆ«é€‚åˆéœ€è¦**æ ‡å‡†åŒ–åˆ†ç±»**çš„ç”Ÿäº§ç¯å¢ƒåº”ç”¨ã€‚

---

### ç”¨æˆ·æŸ¥è¯¢6ï¼š# åˆå§‹åŒ–é¢„å®šä¹‰æ ‡ç­¾ï¼ˆç¡®ä¿æ‰€æœ‰é¢„å®šä¹‰æ ‡ç­¾éƒ½å­˜åœ¨ï¼Œå³ä½¿è®¡æ•°ä¸º0ï¼‰ è¿™ä¸ªæ˜¯å•¥æ„æ€

è®©æˆ‘è¯¦ç»†è§£é‡Šè¿™æ®µä»£ç çš„å«ä¹‰å’Œä½œç”¨ã€‚

## "åˆå§‹åŒ–é¢„å®šä¹‰æ ‡ç­¾ï¼ˆç¡®ä¿æ‰€æœ‰é¢„å®šä¹‰æ ‡ç­¾éƒ½å­˜åœ¨ï¼Œå³ä½¿è®¡æ•°ä¸º0ï¼‰"çš„å«ä¹‰

è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯**ç¡®ä¿æ ‡ç­¾ä½“ç³»çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§**ï¼Œå…·ä½“å«ä¹‰å¦‚ä¸‹ï¼š

### 1. **ä»£ç æ‰§è¡Œæµç¨‹**

```python
# ç¬¬3443-3446è¡Œ
# åˆå§‹åŒ–é¢„å®šä¹‰æ ‡ç­¾ï¼ˆç¡®ä¿æ‰€æœ‰é¢„å®šä¹‰æ ‡ç­¾éƒ½å­˜åœ¨ï¼Œå³ä½¿è®¡æ•°ä¸º0ï¼‰
predefined_tags = {'ä½“è‚²', 'å­¦æœ¯', 'æ”¿æ²»', 'å¨±ä¹', 'æ–‡å­¦', 'æ–‡åŒ–', 'ç»æµ', 'ç§‘æŠ€', 'å†å²', 'åŒ»ç–—', 'å…¶ä»–'}
for tag in predefined_tags:
    self.add_tag(tag)  # è°ƒç”¨add_tagæ–¹æ³•

# add_tagæ–¹æ³•çš„å®ç°ï¼ˆç¬¬3317-3323è¡Œï¼‰
def add_tag(self, tag_name, description=None):
    """æ·»åŠ æ–°æ ‡ç­¾"""
    if tag_name not in self.info['tags']:
        self.info['tags'][tag_name] = {
            'count': 0,        # ğŸ¯ å…³é”®ï¼šè®¡æ•°åˆå§‹åŒ–ä¸º0
            'description': description or ''
        }
```

### 2. **"å³ä½¿è®¡æ•°ä¸º0"çš„å…·ä½“å«ä¹‰**

#### A. **ä¿è¯æ ‡ç­¾ä½“ç³»å®Œæ•´æ€§**
å³ä½¿æŸä¸ªé¢†åŸŸçš„æ ‡ç­¾åœ¨å½“å‰æ•°æ®é›†ä¸­**æ²¡æœ‰ä»»ä½•æ•°æ®**ï¼ˆcount=0ï¼‰ï¼Œç³»ç»Ÿä¹Ÿä¼š**ä¸»åŠ¨åˆ›å»ºè¿™ä¸ªæ ‡ç­¾æ¡ç›®**ï¼Œç¡®ä¿11ä¸ªé¢„å®šä¹‰æ ‡ç­¾éƒ½å­˜åœ¨äºæ ‡ç­¾ä¿¡æ¯æ–‡ä»¶ä¸­ã€‚

#### B. **å®é™…æ•ˆæœå¯¹æ¯”**

**âŒ å¦‚æœæ²¡æœ‰è¿™ä¸ªæœºåˆ¶**ï¼š
```json
{
  "tags": {
    "åŒ»ç–—": {"count": 1, "description": ""}
    // åªæœ‰å®é™…ä½¿ç”¨çš„æ ‡ç­¾ï¼Œå…¶ä»–æ ‡ç­¾ä¸å­˜åœ¨
  }
}
```

**âœ… æœ‰äº†è¿™ä¸ªæœºåˆ¶**ï¼š
```json
{
  "tags": {
    "ä½“è‚²": {"count": 0, "description": ""},    // å³ä½¿æ²¡æœ‰æ•°æ®ä¹Ÿå­˜åœ¨
    "å­¦æœ¯": {"count": 0, "description": ""},    // å³ä½¿æ²¡æœ‰æ•°æ®ä¹Ÿå­˜åœ¨
    "æ”¿æ²»": {"count": 0, "description": ""},    // å³ä½¿æ²¡æœ‰æ•°æ®ä¹Ÿå­˜åœ¨
    "å¨±ä¹": {"count": 0, "description": ""},    // å³ä½¿æ²¡æœ‰æ•°æ®ä¹Ÿå­˜åœ¨
    "æ–‡å­¦": {"count": 0, "description": ""},    // å³ä½¿æ²¡æœ‰æ•°æ®ä¹Ÿå­˜åœ¨
    "æ–‡åŒ–": {"count": 0, "description": ""},    // å³ä½¿æ²¡æœ‰æ•°æ®ä¹Ÿå­˜åœ¨
    "ç»æµ": {"count": 0, "description": ""},    // å³ä½¿æ²¡æœ‰æ•°æ®ä¹Ÿå­˜åœ¨
    "ç§‘æŠ€": {"count": 0, "description": ""},    // å³ä½¿æ²¡æœ‰æ•°æ®ä¹Ÿå­˜åœ¨
    "å†å²": {"count": 0, "description": ""},    // å³ä½¿æ²¡æœ‰æ•°æ®ä¹Ÿå­˜åœ¨
    "åŒ»ç–—": {"count": 1, "description": ""},    // æœ‰æ•°æ®çš„æ ‡ç­¾
    "å…¶ä»–": {"count": 0, "description": ""}     // å³ä½¿æ²¡æœ‰æ•°æ®ä¹Ÿå­˜åœ¨
  }
}
```

### 3. **ä¸ºä»€ä¹ˆéœ€è¦è¿™æ ·åšï¼Ÿ**

#### A. **å‰ç«¯ç•Œé¢ä¸€è‡´æ€§**
- **æ ‡ç­¾ç­›é€‰ç•Œé¢**ï¼šç”¨æˆ·æ€»æ˜¯èƒ½çœ‹åˆ°å®Œæ•´çš„11ä¸ªæ ‡ç­¾é€‰é¡¹ï¼Œå³ä½¿æŸäº›æ ‡ç­¾å½“å‰æ²¡æœ‰æ•°æ®
- **ç»Ÿè®¡å›¾è¡¨**ï¼šå¯ä»¥æ˜¾ç¤ºå®Œæ•´çš„é¢†åŸŸåˆ†å¸ƒï¼ŒåŒ…æ‹¬ç©ºçš„é¢†åŸŸ
- **ç”¨æˆ·ä½“éªŒ**ï¼šé¿å…ç•Œé¢å› æ•°æ®å˜åŒ–è€Œå‡ºç°æ ‡ç­¾é€‰é¡¹çš„åŠ¨æ€å¢å‡

#### B. **æ•°æ®åˆ†æå®Œæ•´æ€§**
- **é¢†åŸŸè¦†ç›–è¯„ä¼°**ï¼šå¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°å“ªäº›é¢†åŸŸæœ‰æ•°æ®ï¼Œå“ªäº›é¢†åŸŸç¼ºä¹æ•°æ®
- **æ•°æ®å¹³è¡¡åˆ†æ**ï¼šå¸®åŠ©è¯†åˆ«æ•°æ®é›†åœ¨å„é¢†åŸŸçš„åˆ†å¸ƒä¸å‡é—®é¢˜
- **å¢é‡å¤„ç†**ï¼šæ–°å¢æ•°æ®æ—¶ï¼Œæ‰€æœ‰æ ‡ç­¾æ¡†æ¶å·²ç»å­˜åœ¨ï¼Œç›´æ¥æ›´æ–°è®¡æ•°å³å¯

#### C. **ç³»ç»Ÿç¨³å®šæ€§**
- **APIä¸€è‡´æ€§**ï¼šæ ‡ç­¾ç›¸å…³çš„APIå§‹ç»ˆè¿”å›å®Œæ•´çš„æ ‡ç­¾åˆ—è¡¨
- **é…ç½®æ ‡å‡†åŒ–**ï¼šæ‰€æœ‰ç¯å¢ƒä¸‹çš„æ ‡ç­¾ä½“ç³»éƒ½ä¿æŒä¸€è‡´
- **é”™è¯¯é¢„é˜²**ï¼šé¿å…å› æ ‡ç­¾ä¸å­˜åœ¨è€Œå¯¼è‡´çš„å‰ç«¯é”™è¯¯

### 4. **å®é™…åº”ç”¨åœºæ™¯**

#### A. **æ–°é¡¹ç›®åˆå§‹åŒ–**
```python
# åˆšå¼€å§‹å¤„ç†æ•°æ®æ—¶ï¼Œæ‰€æœ‰æ ‡ç­¾éƒ½æ˜¯count=0
{
  "tags": {
    "ä½“è‚²": {"count": 0},
    "å­¦æœ¯": {"count": 0},
    "åŒ»ç–—": {"count": 0},
    // ... å…¶ä»–8ä¸ªæ ‡ç­¾éƒ½æ˜¯count=0
  }
}
```

#### B. **æ•°æ®å¤„ç†å**
```python
# å¤„ç†äº†ä¸€äº›åŒ»ç–—ç›¸å…³çš„QAå
{
  "tags": {
    "ä½“è‚²": {"count": 0},      # ä¾ç„¶å­˜åœ¨ï¼Œä½†æ²¡æœ‰æ•°æ®
    "å­¦æœ¯": {"count": 0},      # ä¾ç„¶å­˜åœ¨ï¼Œä½†æ²¡æœ‰æ•°æ®
    "åŒ»ç–—": {"count": 5},      # æœ‰äº†å®é™…æ•°æ®
    // ... å…¶ä»–æ ‡ç­¾ä¿æŒcount=0
  }
}
```

#### C. **é‡æ–°è®¡ç®—æ—¶**
è¿™ä¸ªæœºåˆ¶ç‰¹åˆ«é‡è¦åœ¨`recalculate_all_tags()`æ–¹æ³•ä¸­ï¼š
1. **æ¸…ç©ºæ‰€æœ‰ç°æœ‰æ ‡ç­¾** (ç¬¬3441è¡Œ)
2. **é‡æ–°åˆå§‹åŒ–11ä¸ªé¢„å®šä¹‰æ ‡ç­¾** (ç¬¬3443-3446è¡Œ)
3. **é‡æ–°ç»Ÿè®¡å®é™…æ•°æ®** (ç¬¬3451è¡Œå¼€å§‹)

è¿™ç¡®ä¿äº†å³ä½¿åœ¨é‡æ–°è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œæ ‡ç­¾ä½“ç³»ä¹Ÿå§‹ç»ˆä¿æŒå®Œæ•´ã€‚

## æ€»ç»“

**"ç¡®ä¿æ‰€æœ‰é¢„å®šä¹‰æ ‡ç­¾éƒ½å­˜åœ¨ï¼Œå³ä½¿è®¡æ•°ä¸º0"** çš„å«ä¹‰æ˜¯ï¼š

ç³»ç»Ÿä¼š**ä¸»åŠ¨åˆ›å»ºå¹¶ç»´æŠ¤å®Œæ•´çš„11ä¸ªæ ‡ç­¾æ¡ç›®**ï¼Œä¸ç®¡è¿™äº›æ ‡ç­¾åœ¨å½“å‰æ•°æ®ä¸­æ˜¯å¦è¢«å®é™…ä½¿ç”¨ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ç¡®ä¿**æ ‡ç­¾ä½“ç³»çš„å®Œæ•´æ€§ã€ç•Œé¢çš„ä¸€è‡´æ€§å’Œç³»ç»Ÿçš„ç¨³å®šæ€§**ï¼Œè®©ç”¨æˆ·å’Œç³»ç»Ÿå§‹ç»ˆèƒ½å¤Ÿçœ‹åˆ°å’Œæ“ä½œå®Œæ•´çš„æ ‡ç­¾æ¡†æ¶ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªéšæ•°æ®åŠ¨æ€å˜åŒ–çš„ä¸å®Œæ•´æ ‡ç­¾åˆ—è¡¨ã€‚

---

### ç”¨æˆ·æŸ¥è¯¢7ï¼šsmart auto-taggingæ˜¯å¯¹ç”Ÿæˆçš„QAæ•°æ®è¿›è¡Œåˆ†ç±»ï¼Œé‚£ä¹ˆåˆ†ç±»çš„ä½œç”¨æ˜¯ä»€ä¹ˆ

è®©æˆ‘æ·±å…¥åˆ†æSmart Auto-Taggingå¯¹ç”Ÿæˆçš„QAæ•°æ®è¿›è¡Œåˆ†ç±»åçš„å…·ä½“ä½œç”¨å’Œåº”ç”¨ä»·å€¼ã€‚

åŸºäºæ·±å…¥çš„ä»£ç åˆ†æï¼Œæˆ‘å¯ä»¥è¯¦ç»†è§£é‡Š**Smart Auto-Taggingå¯¹ç”Ÿæˆçš„QAæ•°æ®è¿›è¡Œåˆ†ç±»çš„ä½œç”¨**ï¼š

## Smart Auto-Taggingåˆ†ç±»çš„æ ¸å¿ƒä½œç”¨

### 1. **æ•°æ®ç»„ç»‡ä¸ç®¡ç†**

#### A. **å¤šç»´åº¦æ•°æ®ç­›é€‰**
- **ç²¾ç¡®ç­›é€‰**ï¼šç”¨æˆ·å¯ä»¥æŒ‰é¢†åŸŸæ ‡ç­¾ç­›é€‰ç‰¹å®šç±»å‹çš„QAæ•°æ®
- **ç»„åˆç­›é€‰**ï¼šæ”¯æŒå¤šä¸ªæ ‡ç­¾çš„AND/ORé€»è¾‘ç»„åˆç­›é€‰
- **å®æ—¶æœç´¢**ï¼šç»“åˆæ–‡æœ¬æœç´¢å’Œæ ‡ç­¾ç­›é€‰ï¼Œå¿«é€Ÿå®šä½ç›®æ ‡æ•°æ®

**ä»£ç å®ç°**ï¼ˆfinal_datasets.js ç¬¬258-266è¡Œï¼‰ï¼š
```javascript
// é¢†åŸŸæ ‡ç­¾ç­›é€‰
if (this.filters.domainTags.length > 0) {
    const itemTags = item.domain_tags || [];
    if (this.filters.domainTagsLogic === 'or') {
        // ORé€»è¾‘ï¼šåŒ…å«ä»»ä¸€æ ‡ç­¾å³å¯
        if (!this.filters.domainTags.some(tag => itemTags.includes(tag))) return false;
    } else {
        // ANDé€»è¾‘ï¼šå¿…é¡»åŒ…å«æ‰€æœ‰æ ‡ç­¾
        if (!this.filters.domainTags.every(tag => itemTags.includes(tag))) return false;
    }
}
```

#### B. **æ•°æ®å¯è§†åŒ–å±•ç¤º**
- **æ ‡ç­¾å¾½ç« **ï¼šQAæ•°æ®ä»¥å½©è‰²æ ‡ç­¾å½¢å¼æ˜¾ç¤ºé¢†åŸŸå½’å±
- **ç»Ÿè®¡åˆ†æ**ï¼šæ˜¾ç¤ºå„é¢†åŸŸæ•°æ®åˆ†å¸ƒå’Œæ•°é‡ç»Ÿè®¡
- **åˆ†é¡µæµè§ˆ**ï¼šæŒ‰æ ‡ç­¾åˆ†ç±»åçš„æ•°æ®æ”¯æŒåˆ†é¡µæµè§ˆ

### 2. **ä¸“ä¸šåŒ–æ•°æ®å¯¼å‡º**

#### A. **æŒ‰éœ€å¯¼å‡ºåŠŸèƒ½**
- **é€‰æ‹©æ€§å¯¼å‡º**ï¼šåªå¯¼å‡ºç‰¹å®šé¢†åŸŸçš„QAæ•°æ®
- **å­—æ®µå®šåˆ¶**ï¼šé€‰æ‹©å¯¼å‡ºçš„æ•°æ®å­—æ®µï¼ŒåŒ…å«æˆ–æ’é™¤æ ‡ç­¾ä¿¡æ¯
- **æ ¼å¼æ”¯æŒ**ï¼šæ”¯æŒJSONã€JSONLç­‰å¤šç§å¯¼å‡ºæ ¼å¼

**ä»£ç å®ç°**ï¼ˆfinal_datasets.js ç¬¬763-783è¡Œï¼‰ï¼š
```javascript
async exportData() {
    // åªå¯¼å‡ºç­›é€‰åçš„æ•°æ®
    const dataToExport = this.filteredData.map(item => {
        const exportItem = {};
        Object.keys(this.visibleFields).forEach(field => {
            if (this.visibleFields[field]) {
                exportItem[field] = item[field]; // åŒ…å«domain_tagså­—æ®µ
            }
        });
        return exportItem;
    });
    
    // ç”Ÿæˆå¸¦æ—¶é—´æˆ³çš„å¯¼å‡ºæ–‡ä»¶
    a.download = `final_datasets_export_${new Date().toISOString().slice(0, 10)}.json`;
}
```

### 3. **è´¨é‡æ§åˆ¶ä¸è¯„ä¼°**

#### A. **é¢†åŸŸä¸“ä¸šåŒ–è´¨é‡æ£€æŸ¥**
- **é¢†åŸŸä¸€è‡´æ€§**ï¼šç¡®ä¿åŒä¸€æ ‡ç­¾ä¸‹çš„QAå†…å®¹é¢†åŸŸç›¸å…³æ€§
- **æ•°æ®å¹³è¡¡æ€§**ï¼šè¯†åˆ«å„é¢†åŸŸæ•°æ®åˆ†å¸ƒæ˜¯å¦å‡è¡¡
- **ä¸“ä¸šæ€§éªŒè¯**ï¼šæ£€æŸ¥è·¨é¢†åŸŸæˆ–åˆ†ç±»ä¸å½“çš„é—®é¢˜

#### B. **æ•°æ®å®Œæ•´æ€§ç®¡ç†**
- **è¦†ç›–åº¦åˆ†æ**ï¼šæŸ¥çœ‹å“ªäº›é¢†åŸŸæœ‰å……è¶³æ•°æ®ï¼Œå“ªäº›é¢†åŸŸç¼ºä¹æ•°æ®
- **å¢é‡æ›´æ–°**ï¼šæ–°å¢æ•°æ®æ—¶æŒ‰æ ‡ç­¾è¿›è¡Œå¢é‡è´¨é‡æ§åˆ¶

### 4. **ç”Ÿäº§éƒ¨ç½²åº”ç”¨**

#### A. **å‚ç›´é¢†åŸŸåº”ç”¨**
æ ¹æ®features-guide.mdä¸­çš„åº”ç”¨åœºæ™¯ï¼š

**ğŸ¢ ä¼ä¸šåº”ç”¨åœºæ™¯**ï¼š
```
Domain Terms â†’ Custom Tagging â†’ Batch Processing â†’ Quality Control â†’ Production Deployment
```

- **åŒ»ç–—AIç³»ç»Ÿ**ï¼šç­›é€‰"åŒ»ç–—"æ ‡ç­¾çš„QAæ•°æ®è®­ç»ƒåŒ»ç–—é—®ç­”æ¨¡å‹
- **æ•™è‚²å¹³å°**ï¼šä½¿ç”¨"å­¦æœ¯"æ ‡ç­¾æ•°æ®æ„å»ºå­¦ç§‘ä¸“ä¸šé—®ç­”ç³»ç»Ÿ
- **é‡‘èæœåŠ¡**ï¼šæå–"ç»æµ"æ ‡ç­¾æ•°æ®å¼€å‘é‡‘èå’¨è¯¢æœºå™¨äºº

#### B. **æ¨¡å‹è®­ç»ƒæ•°æ®å‡†å¤‡**
- **é¢†åŸŸç‰¹åŒ–**ï¼šä¸ºä¸åŒå‚ç›´é¢†åŸŸçš„AIæ¨¡å‹å‡†å¤‡ä¸“ä¸šåŒ–è®­ç»ƒæ•°æ®
- **æ•°æ®å¹³è¡¡**ï¼šç¡®ä¿è®­ç»ƒé›†åœ¨å„é¢†åŸŸåˆ†å¸ƒå‡è¡¡
- **æµ‹è¯•é›†æ„å»º**ï¼šæŒ‰é¢†åŸŸåˆ’åˆ†æµ‹è¯•é›†ï¼Œè¯„ä¼°æ¨¡å‹åœ¨ä¸åŒé¢†åŸŸçš„è¡¨ç°

### 5. **ç ”ç©¶ä¸åˆ†ææ”¯æŒ**

#### A. **å­¦æœ¯ç ”ç©¶åº”ç”¨**
**ğŸ”¬ ç ”ç©¶å¼€å‘åœºæ™¯**ï¼š
```
Literature Entities â†’ Parameter Tuning â†’ Large-scale Generation â†’ Comparative Analysis â†’ Publication
```

- **è·¨é¢†åŸŸåˆ†æ**ï¼šæ¯”è¾ƒä¸åŒé¢†åŸŸQAæ•°æ®çš„ç‰¹å¾å’Œè´¨é‡
- **é¢†åŸŸå»ºæ¨¡**ï¼šç ”ç©¶ç‰¹å®šé¢†åŸŸçš„çŸ¥è¯†è¡¨ç¤ºå’Œæ¨ç†æ¨¡å¼
- **æ•°æ®é›†å‘å¸ƒ**ï¼šæŒ‰é¢†åŸŸå‘å¸ƒæ ‡å‡†åŒ–çš„å­¦æœ¯æ•°æ®é›†

#### B. **ä¸šåŠ¡æ™ºèƒ½åˆ†æ**
- **å†…å®¹ç­–ç•¥**ï¼šåˆ†æå“ªäº›é¢†åŸŸçš„é—®ç­”éœ€æ±‚æœ€å¤§
- **èµ„æºåˆ†é…**ï¼šåŸºäºæ ‡ç­¾ç»Ÿè®¡ä¼˜åŒ–å†…å®¹ç”Ÿäº§èµ„æºé…ç½®
- **ç”¨æˆ·ç”»åƒ**ï¼šäº†è§£ç”¨æˆ·åœ¨ä¸åŒé¢†åŸŸçš„é—®ç­”åå¥½

### 6. **ç³»ç»Ÿé›†æˆä¸APIæœåŠ¡**

#### A. **å¾®æœåŠ¡æ¶æ„æ”¯æŒ**
- **é¢†åŸŸè·¯ç”±**ï¼šæ ¹æ®æ ‡ç­¾å°†é—®ç­”è¯·æ±‚è·¯ç”±åˆ°ä¸“ä¸šåŒ–çš„æœåŠ¡æ¨¡å—
- **ç¼“å­˜ç­–ç•¥**ï¼šæŒ‰é¢†åŸŸè¿›è¡Œæ•°æ®ç¼“å­˜å’Œç´¢å¼•ä¼˜åŒ–
- **è´Ÿè½½å‡è¡¡**ï¼šåŸºäºé¢†åŸŸæ ‡ç­¾è¿›è¡ŒæœåŠ¡è´Ÿè½½åˆ†é…

#### B. **ç¬¬ä¸‰æ–¹é›†æˆ**
- **APIç­›é€‰**ï¼šæä¾›æŒ‰æ ‡ç­¾ç­›é€‰çš„æ•°æ®APIæ¥å£
- **æ•°æ®åŒæ­¥**ï¼šå‘ä¸‹æ¸¸ç³»ç»ŸæŒ‰é¢†åŸŸåŒæ­¥ç›¸å…³æ•°æ®
- **æƒé™æ§åˆ¶**ï¼šåŸºäºç”¨æˆ·æƒé™æ§åˆ¶ä¸åŒé¢†åŸŸæ•°æ®çš„è®¿é—®

### 7. **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**

#### A. **ä¸ªæ€§åŒ–æ¨è**
- **å†…å®¹æ¨è**ï¼šåŸºäºç”¨æˆ·å…´è¶£é¢†åŸŸæ¨èç›¸å…³QAå†…å®¹
- **æ™ºèƒ½æœç´¢**ï¼šç»“åˆé¢†åŸŸæ ‡ç­¾æå‡æœç´¢ç»“æœçš„ç›¸å…³æ€§
- **ç•Œé¢å®šåˆ¶**ï¼šå…è®¸ç”¨æˆ·å…³æ³¨ç‰¹å®šé¢†åŸŸçš„å†…å®¹

#### B. **å·¥ä½œæµç¨‹ä¼˜åŒ–**
- **æ‰¹é‡æ“ä½œ**ï¼šæ”¯æŒæŒ‰æ ‡ç­¾æ‰¹é‡å¤„ç†ã€ç¼–è¾‘ã€åˆ é™¤æ•°æ®
- **æ¨¡æ¿ç®¡ç†**ï¼šä¸ºä¸åŒé¢†åŸŸæä¾›ä¸“ä¸šåŒ–çš„QAæ¨¡æ¿
- **å®¡æ ¸æµç¨‹**ï¼šæŒ‰é¢†åŸŸè®¾ç½®ä¸åŒçš„å†…å®¹å®¡æ ¸æ ‡å‡†

## å®é™…ä¸šåŠ¡ä»·å€¼æ€»ç»“

Smart Auto-Taggingçš„åˆ†ç±»ä½œç”¨ä½“ç°åœ¨ï¼š

1. **ğŸ¯ ç²¾å‡†å®šä½**ï¼šä»æµ·é‡QAæ•°æ®ä¸­å¿«é€Ÿå®šä½ç‰¹å®šé¢†åŸŸå†…å®¹
2. **ğŸ“Š æ•°æ®æ´å¯Ÿ**ï¼šé€šè¿‡æ ‡ç­¾ç»Ÿè®¡äº†è§£æ•°æ®åˆ†å¸ƒå’Œè´¨é‡çŠ¶å†µ  
3. **ğŸš€ æ•ˆç‡æå‡**ï¼šæ”¯æŒæ‰¹é‡å¤„ç†å’Œè‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹
4. **ğŸ”§ çµæ´»åº”ç”¨**ï¼šä¸ºä¸åŒä¸šåŠ¡åœºæ™¯æä¾›å®šåˆ¶åŒ–æ•°æ®æœåŠ¡
5. **ğŸ“ˆ è§„æ¨¡åŒ–**ï¼šæ”¯æŒå¤§è§„æ¨¡æ•°æ®çš„æ ‡å‡†åŒ–ç®¡ç†å’Œåº”ç”¨
6. **ğŸ¨ ç”¨æˆ·å‹å¥½**ï¼šæä¾›ç›´è§‚çš„å¯è§†åŒ–ç•Œé¢å’Œäº¤äº’ä½“éªŒ

è¿™ä¸ªåˆ†ç±»ç³»ç»Ÿå°†åŸæœ¬æ‚ä¹±æ— ç« çš„QAæ•°æ®è½¬åŒ–ä¸º**ç»“æ„åŒ–ã€å¯æ£€ç´¢ã€å¯åˆ†æçš„çŸ¥è¯†èµ„äº§**ï¼Œä¸ºAIåº”ç”¨çš„å‚ç›´åŒ–å’Œä¸“ä¸šåŒ–æä¾›äº†é‡è¦çš„æ•°æ®åŸºç¡€è®¾æ–½æ”¯æŒã€‚

---

### ç”¨æˆ·æŸ¥è¯¢8ï¼šç»™æˆ‘è§£é‡Šä¸‹ï¼šDomain Terms â†’ Custom Tagging â†’ Batch Processing â†’ Quality Control â†’ Production Deployment

è®©æˆ‘è¯¦ç»†è§£é‡Šè¿™ä¸ªä¼ä¸šçº§åº”ç”¨åœºæ™¯çš„å®Œæ•´å·¥ä½œæµç¨‹ã€‚

## ä¼ä¸šçº§åº”ç”¨åœºæ™¯å·¥ä½œæµç¨‹è¯¦è§£

è¿™ä¸ªå·¥ä½œæµç¨‹ä»£è¡¨äº†**ä¼ä¸šçº§çŸ¥è¯†é—®ç­”ç³»ç»Ÿçš„å®Œæ•´ç”Ÿäº§æµæ°´çº¿**ï¼Œæˆ‘æ¥è¯¦ç»†è§£é‡Šæ¯ä¸ªé˜¶æ®µï¼š

### 1. **Domain Termsï¼ˆé¢†åŸŸæœ¯è¯­å‡†å¤‡ï¼‰** ğŸ¯

#### **é˜¶æ®µç›®æ ‡**ï¼šæ”¶é›†å’Œæ•´ç†ä¼ä¸šç‰¹å®šé¢†åŸŸçš„æ ¸å¿ƒæœ¯è¯­

#### **å…·ä½“æ“ä½œ**ï¼š
- **æœ¯è¯­æ”¶é›†**ï¼šä»ä¼ä¸šæ–‡æ¡£ã€äº§å“æ‰‹å†Œã€è¡Œä¸šæ ‡å‡†ä¸­æå–å…³é”®æœ¯è¯­
- **ä¸“ä¸šè¯æ±‡åº“**ï¼šå»ºç«‹ä¼ä¸šä¸“ç”¨çš„é¢†åŸŸè¯æ±‡è¡¨
- **å®ä½“è¯†åˆ«**ï¼šç¡®å®šæ ¸å¿ƒä¸šåŠ¡å®ä½“ï¼ˆäº§å“åã€æŠ€æœ¯æ¦‚å¿µã€ä¸šåŠ¡æµç¨‹ç­‰ï¼‰

#### **ä½¿ç”¨çš„ç³»ç»ŸåŠŸèƒ½**ï¼š
- **ğŸ“ Single QA Testing Page**: æµ‹è¯•å•ä¸ªé¢†åŸŸæœ¯è¯­çš„æ•ˆæœ
  - è¾“å…¥ä¼ä¸šç‰¹å®šæœ¯è¯­ï¼ˆå¦‚"é£é™©è¯„ä¼°æ¨¡å‹"ã€"å®¢æˆ·ç”Ÿå‘½å‘¨æœŸç®¡ç†"ï¼‰
  - éªŒè¯çŸ¥è¯†å›¾è°±æ„å»ºè´¨é‡
  - è°ƒè¯•å‚æ•°è®¾ç½®

#### **å®é™…ä¾‹å­**ï¼š
```
é‡‘èä¼ä¸šï¼šä¿¡è´·é£é™©ã€KYCåˆè§„ã€åæ´—é’±ã€èµ„äº§è¯åˆ¸åŒ–
åŒ»ç–—ä¼ä¸šï¼šä¸´åºŠè¯•éªŒã€è¯ç‰©ç›¸äº’ä½œç”¨ã€è¯Šæ–­æ ‡å‡†ã€æ²»ç–—æ–¹æ¡ˆ
åˆ¶é€ ä¼ä¸šï¼šä¾›åº”é“¾ç®¡ç†ã€è´¨é‡æ§åˆ¶ã€ç²¾ç›Šç”Ÿäº§ã€è®¾å¤‡ç»´æŠ¤
```

---

### 2. **Custom Taggingï¼ˆè‡ªå®šä¹‰æ ‡ç­¾åŒ–ï¼‰** ğŸ·ï¸

#### **é˜¶æ®µç›®æ ‡**ï¼šä¸ºç”Ÿæˆçš„QAæ•°æ®è¿›è¡Œæ™ºèƒ½é¢†åŸŸåˆ†ç±»

#### **å…·ä½“æ“ä½œ**ï¼š
- **æ™ºèƒ½åˆ†ç±»**ï¼šä½¿ç”¨Smart Auto-Taggingå¯¹QAæ•°æ®è¿›è¡Œè‡ªåŠ¨é¢†åŸŸæ ‡ç­¾
- **æ ‡ç­¾éªŒè¯**ï¼šäººå·¥å®¡æ ¸å’Œè°ƒæ•´è‡ªåŠ¨æ ‡ç­¾ç»“æœ
- **æ ‡ç­¾ä½“ç³»**ï¼šæ ¹æ®ä¼ä¸šéœ€æ±‚å®šåˆ¶æ ‡ç­¾åˆ†ç±»ä½“ç³»

#### **ä½¿ç”¨çš„ç³»ç»ŸåŠŸèƒ½**ï¼š
- **ğŸ·ï¸ Domain Tagging Page**: æ ¸å¿ƒæ ‡ç­¾åŒ–åŠŸèƒ½
  - æ‰¹é‡å¤„ç†QAæ•°æ®æ–‡ä»¶
  - 11ä¸ªé¢„å®šä¹‰æ ‡ç­¾ï¼šä½“è‚²ã€å­¦æœ¯ã€æ”¿æ²»ã€å¨±ä¹ã€æ–‡å­¦ã€æ–‡åŒ–ã€ç»æµã€ç§‘æŠ€ã€å†å²ã€åŒ»ç–—ã€å…¶ä»–
  - æ‰‹åŠ¨æ ¡æ­£å’Œæ‰¹é‡ä¿®æ”¹
  - æ ‡ç­¾ç»Ÿè®¡å’Œåˆ†å¸ƒåˆ†æ

#### **å®é™…æ•ˆæœ**ï¼š
```json
// åŸå§‹QAæ•°æ®
{
  "question": "å¦‚ä½•è¯„ä¼°ä¼ä¸šçš„ä¿¡è´·é£é™©ç­‰çº§ï¼Ÿ",
  "answer": "é€šè¿‡åˆ†æè´¢åŠ¡æŠ¥è¡¨ã€ç°é‡‘æµã€è¡Œä¸šé£é™©ç­‰å› ç´ ..."
}

// æ ‡ç­¾åŒ–å
{
  "question": "å¦‚ä½•è¯„ä¼°ä¼ä¸šçš„ä¿¡è´·é£é™©ç­‰çº§ï¼Ÿ",
  "answer": "é€šè¿‡åˆ†æè´¢åŠ¡æŠ¥è¡¨ã€ç°é‡‘æµã€è¡Œä¸šé£é™©ç­‰å› ç´ ...",
  "domain_tags": ["ç»æµ"]  // ğŸ¯ æ™ºèƒ½æ ‡ç­¾
}
```

---

### 3. **Batch Processingï¼ˆæ‰¹é‡å¤„ç†ï¼‰** ğŸš€

#### **é˜¶æ®µç›®æ ‡**ï¼šå¤§è§„æ¨¡ç”Ÿäº§é«˜è´¨é‡çš„QAæ•°æ®é›†

#### **å…·ä½“æ“ä½œ**ï¼š
- **è§„æ¨¡åŒ–ç”Ÿæˆ**ï¼šæ‰¹é‡å¤„ç†æˆç™¾ä¸Šåƒä¸ªé¢†åŸŸæœ¯è¯­
- **å‚æ•°ä¼˜åŒ–**ï¼šé’ˆå¯¹ä¼ä¸šéœ€æ±‚è°ƒæ•´ç”Ÿæˆå‚æ•°
- **è´¨é‡æ§åˆ¶**ï¼šè®¾ç½®è´¨é‡ç­‰çº§å’Œå¹¶å‘æ§åˆ¶
- **è¿›åº¦ç›‘æ§**ï¼šå®æ—¶è·Ÿè¸ªå¤„ç†è¿›åº¦å’ŒæˆåŠŸç‡

#### **ä½¿ç”¨çš„ç³»ç»ŸåŠŸèƒ½**ï¼š
- **ğŸš€ Batch Generation Page**: å¤§è§„æ¨¡æ•°æ®ç”Ÿäº§
  - æ”¯æŒ1-1000ä¸ªå®ä½“çš„æ‰¹é‡å¤„ç†
  - å¤šç§æ•°æ®æºï¼šæ‰‹åŠ¨è¾“å…¥ã€æ–‡ä»¶ä¸Šä¼ ï¼ˆ.txt, .csv, .json, .jsonlï¼‰
  - è´¨é‡ç­‰çº§è®¾ç½®ï¼šå¿«é€Ÿ/æ ‡å‡†/é«˜è´¨é‡æ¨¡å¼
  - å®æ—¶ç›‘æ§ï¼šè¿›åº¦æ¡ã€æˆåŠŸç‡ç»Ÿè®¡ã€ETAé¢„ä¼°
  - å¹¶å‘æ§åˆ¶ï¼šQPSé™åˆ¶ï¼Œé¿å…APIè¿‡è½½

#### **ä¼ä¸šçº§é…ç½®ç¤ºä¾‹**ï¼š
```
å¤„ç†è§„æ¨¡ï¼š500ä¸ªæ ¸å¿ƒä¸šåŠ¡æœ¯è¯­
è´¨é‡æ¨¡å¼ï¼šé«˜è´¨é‡ï¼ˆmax_nodes=400, iterations=15ï¼‰
å¹¶å‘è®¾ç½®ï¼šQPS=3ï¼Œ5ä¸ªå¹¶å‘worker
é¢„ä¼°æ—¶é—´ï¼š8-12å°æ—¶å®Œæˆ
è¾“å‡ºæ ¼å¼ï¼šJSONLï¼Œæ¯ä¸ªæœ¯è¯­ç”Ÿæˆ8-15ä¸ªQAå¯¹
```

---

### 4. **Quality Controlï¼ˆè´¨é‡æ§åˆ¶ï¼‰** ğŸ“Š

#### **é˜¶æ®µç›®æ ‡**ï¼šç¡®ä¿QAæ•°æ®çš„å‡†ç¡®æ€§ã€ä¸€è‡´æ€§å’Œä¼ä¸šé€‚ç”¨æ€§

#### **å…·ä½“æ“ä½œ**ï¼š
- **è‡ªåŠ¨è¯„ä¼°**ï¼šä½¿ç”¨AIæ¨¡å‹è¯„ä¼°ç­”æ¡ˆè´¨é‡
- **äººå·¥å®¡æ ¸**ï¼šä¸“ä¸šäººå‘˜å®¡æ ¸å…³é”®é¢†åŸŸçš„QAå¯¹
- **å¯¹æ¯”åˆ†æ**ï¼šä¸åŒç®—æ³•ç”Ÿæˆç»“æœçš„å¯¹æ¯”
- **æ•°æ®æ¸…æ´—**ï¼šå»é‡ã€æ ¼å¼æ ‡å‡†åŒ–ã€é”™è¯¯ä¿®æ­£

#### **ä½¿ç”¨çš„ç³»ç»ŸåŠŸèƒ½**ï¼š

**A. ğŸ“Š Data Evaluation Page**: æ™ºèƒ½è´¨é‡è¯„ä¼°
- DeepSeek R1æ¨¡å‹è¿›è¡Œé«˜è´¨é‡ç­”æ¡ˆç”Ÿæˆ
- å¤šç»´åº¦è¯„ä¼°ï¼šå‡†ç¡®æ€§ã€ç›¸ä¼¼åº¦ã€è¯­è¨€è´¨é‡ã€é€»è¾‘ä¸€è‡´æ€§
- å¯è§†åŒ–åˆ†æï¼šChart.jså›¾è¡¨ã€é›·è¾¾å›¾ã€è¶‹åŠ¿åˆ†æ
- æ‰¹é‡è¯„ä¼°ä»»åŠ¡ç®¡ç†

**B. ğŸ†š Comparison Evaluation Page**: A/Bæµ‹è¯•æ¡†æ¶
- å¤šä¸ªæ•°æ®é›†çš„å¹¶è¡Œæ¯”è¾ƒ
- ä¸åŒæ¨¡å‹æ€§èƒ½å¯¹æ¯”
- ç®—æ³•æ•ˆæœå¯¹æ¯”åˆ†æ
- ç»Ÿè®¡æ˜¾è‘—æ€§æµ‹è¯•

**C. ğŸ—ƒï¸ Data Management Page**: æ•°æ®æ¸…ç†å·¥å…·
- æ™ºèƒ½å†…å®¹é¢„è§ˆå’Œåˆ†é¡µ
- å…³é”®è¯æœç´¢å’Œè¿‡æ»¤
- å¼‚å¸¸æ£€æµ‹å’Œæ ‡è®°
- è¯­è¨€æ£€æµ‹ã€ä¿¡æ¯æ³„éœ²æ£€æµ‹ã€å®ä½“æ›¿æ¢
- é‡å¤æ•°æ®ç§»é™¤

#### **è´¨é‡æ§åˆ¶æŒ‡æ ‡**ï¼š
```
å‡†ç¡®æ€§è¯„åˆ†ï¼šâ‰¥85%
è¯­ä¹‰ç›¸ä¼¼åº¦ï¼šâ‰¥0.8
é€»è¾‘ä¸€è‡´æ€§ï¼šâ‰¥90%
é¢†åŸŸç›¸å…³æ€§ï¼šâ‰¥95%
é‡å¤ç‡ï¼šâ‰¤5%
```

---

### 5. **Production Deploymentï¼ˆç”Ÿäº§éƒ¨ç½²ï¼‰** ğŸ¯

#### **é˜¶æ®µç›®æ ‡**ï¼šå°†é«˜è´¨é‡QAæ•°æ®é›†éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

#### **å…·ä½“æ“ä½œ**ï¼š
- **æœ€ç»ˆå®¡æ ¸**ï¼šå¯¹é€šè¿‡è´¨é‡æ§åˆ¶çš„æ•°æ®è¿›è¡Œæœ€ç»ˆç¡®è®¤
- **ç‰ˆæœ¬ç®¡ç†**ï¼šä¸ºæ•°æ®é›†åˆ†é…ç‰ˆæœ¬å·å’Œå…ƒæ•°æ®
- **æ ¼å¼è½¬æ¢**ï¼šè½¬æ¢ä¸ºç”Ÿäº§ç¯å¢ƒæ‰€éœ€çš„æ ¼å¼
- **éƒ¨ç½²å‘å¸ƒ**ï¼šå‘å¸ƒåˆ°ä¼ä¸šAIç³»ç»Ÿã€çŸ¥è¯†åº“æˆ–APIæœåŠ¡

#### **ä½¿ç”¨çš„ç³»ç»ŸåŠŸèƒ½**ï¼š
- **ğŸ¯ Final Datasets Page**: ç”Ÿäº§å°±ç»ªçš„æ•°æ®ç®¡ç†
  - æœ€ç»ˆæ•°æ®é›†æ¦‚è§ˆå’Œç‰ˆæœ¬æ§åˆ¶
  - é«˜çº§å¤šç»´åº¦ç­›é€‰ï¼ˆæŒ‰æ ‡ç­¾ã€å®ä½“ã€è¯­è¨€ç­‰ï¼‰
  - å”¯ä¸€IDç®¡ç†å’ŒéªŒè¯
  - é‡å¤æ•°æ®æ£€æµ‹å’Œæ•°æ®å®Œæ•´æ€§æ£€æŸ¥
  - å¤šæ ¼å¼å¯¼å‡ºï¼šJSONã€JSONLã€CSV
  - éƒ¨ç½²å°±ç»ªçš„æ•°æ®åŒ…ç”Ÿæˆ

#### **éƒ¨ç½²é…ç½®ç¤ºä¾‹**ï¼š
```json
{
  "dataset_info": {
    "name": "enterprise_financial_qa_v2.1",
    "version": "2.1.0",
    "total_qa_pairs": 3247,
    "domain_distribution": {
      "ç»æµ": 2156,
      "ç§‘æŠ€": 891,
      "å…¶ä»–": 200
    },
    "quality_score": 0.92,
    "last_updated": "2025-01-15T10:30:00Z"
  },
  "deployment_target": "production_api",
  "format": "jsonl",
  "access_level": "internal_only"
}
```

---

## å®Œæ•´æµç¨‹çš„ä¼ä¸šä»·å€¼

### **ğŸ¯ ä¸šåŠ¡åœºæ™¯ç¤ºä¾‹ï¼šé‡‘èä¼ä¸šæ™ºèƒ½å®¢æœç³»ç»Ÿ**

```
1. Domain Terms: æ”¶é›†ä¿¡è´·ã€ç†è´¢ã€ä¿é™©ç­‰é‡‘èæœ¯è¯­
   â†“
2. Custom Tagging: å°†QAæŒ‰"ç»æµ"ã€"ç§‘æŠ€"ç­‰æ ‡ç­¾åˆ†ç±»
   â†“  
3. Batch Processing: æ‰¹é‡ç”Ÿæˆ5000+é‡‘èé—®ç­”å¯¹
   â†“
4. Quality Control: AI+äººå·¥å®¡æ ¸ç¡®ä¿ä¸“ä¸šæ€§å’Œå‡†ç¡®æ€§
   â†“
5. Production Deployment: éƒ¨ç½²åˆ°å®¢æœæœºå™¨äººå’ŒçŸ¥è¯†åº“
```

### **ğŸ“ˆ å…³é”®æˆåŠŸæŒ‡æ ‡**

- **æ•ˆç‡æå‡**ï¼šä»æ‰‹å·¥ç¼–å†™åˆ°è‡ªåŠ¨åŒ–ç”Ÿæˆï¼Œæ•ˆç‡æå‡10-50å€
- **è´¨é‡ä¿è¯**ï¼šå¤šå±‚è´¨é‡æ§åˆ¶ç¡®ä¿90%+çš„å‡†ç¡®ç‡
- **è§„æ¨¡åŒ–**ï¼šæ”¯æŒä¼ä¸šçº§å¤§è§„æ¨¡æ•°æ®ç”Ÿäº§ï¼ˆåƒçº§åˆ°ä¸‡çº§QAå¯¹ï¼‰
- **ä¸“ä¸šåŒ–**ï¼šé¢†åŸŸæ ‡ç­¾ç¡®ä¿å†…å®¹çš„ä¸“ä¸šæ€§å’Œç›¸å…³æ€§
- **å¯ç»´æŠ¤æ€§**ï¼šç‰ˆæœ¬ç®¡ç†å’Œå¢é‡æ›´æ–°æ”¯æŒé•¿æœŸç»´æŠ¤

è¿™ä¸ªå·¥ä½œæµç¨‹å°†**åŸå§‹çš„é¢†åŸŸæœ¯è¯­è½¬åŒ–ä¸ºå¯ç›´æ¥æŠ•å…¥ç”Ÿäº§ä½¿ç”¨çš„é«˜è´¨é‡QAæ•°æ®é›†**ï¼Œä¸ºä¼ä¸šAIåº”ç”¨æä¾›äº†ä¸“ä¸šåŒ–ã€æ ‡å‡†åŒ–çš„çŸ¥è¯†åŸºç¡€è®¾æ–½ã€‚

---

### ç”¨æˆ·æŸ¥è¯¢9ï¼šæœ€ç»ˆæ•°æ®è¦æ€ä¹ˆç”Ÿæˆ

è®©æˆ‘è¯¦ç»†è§£é‡Šæœ€ç»ˆæ•°æ®çš„ç”Ÿæˆè¿‡ç¨‹ï¼Œä»åŸå§‹è¾“å…¥åˆ°å¯éƒ¨ç½²çš„ç”Ÿäº§æ•°æ®çš„å®Œæ•´æµç¨‹ã€‚

## æœ€ç»ˆæ•°æ®ç”Ÿæˆçš„å®Œæ•´æµç¨‹

åŸºäºç³»ç»Ÿåˆ†æï¼Œæˆ‘æ¥è¯¦ç»†è§£é‡Šæœ€ç»ˆæ•°æ®æ˜¯å¦‚ä½•ç”Ÿæˆçš„ï¼š

### 1. **æ•°æ®è¾“å…¥é˜¶æ®µ** ğŸ“

#### A. **ç§å­å®ä½“å‡†å¤‡**
```
è¾“å…¥æ–¹å¼ï¼š
â”œâ”€â”€ æ‰‹åŠ¨è¾“å…¥ï¼šç›´æ¥åœ¨ç•Œé¢è¾“å…¥å®ä½“åˆ—è¡¨ï¼ˆå¦‚"ç³–å°¿ç—…,é«˜è¡€å‹,å¿ƒè„ç—…"ï¼‰
â”œâ”€â”€ æ–‡ä»¶ä¸Šä¼ ï¼šæ”¯æŒå¤šç§æ ¼å¼
â”‚   â”œâ”€â”€ .txtï¼šæ¯è¡Œä¸€ä¸ªå®ä½“
â”‚   â”œâ”€â”€ .csvï¼šåŒ…å«å®ä½“åç§°çš„CSVæ–‡ä»¶
â”‚   â”œâ”€â”€ .json/.jsonlï¼šç»“æ„åŒ–å®ä½“æ•°æ®
â””â”€â”€ é¢„è®¾å®ä½“é›†ï¼šä»evaluation_data/entity_sets/é€‰æ‹©ç°æœ‰çš„å®ä½“é›†
```

#### B. **å®ä½“é›†ç¤ºä¾‹**
```csv
# medical_entities.csv
entity_name,domain,priority
ç³–å°¿ç—…,åŒ»ç–—,é«˜
é«˜è¡€å‹,åŒ»ç–—,é«˜  
å¿ƒè„ç—…,åŒ»ç–—,é«˜
è‚ºç‚,åŒ»ç–—,ä¸­
```

---

### 2. **çŸ¥è¯†å›¾è°±æ„å»ºé˜¶æ®µ** ğŸ”—

#### A. **å•å®ä½“å¤„ç†æµç¨‹**
```
å®ä½“è¾“å…¥ â†’ æœç´¢å¼•æ“æŸ¥è¯¢ â†’ æ–‡æœ¬æ”¶é›† â†’ LLMå®ä½“å…³ç³»æŠ½å– â†’ å›¾ç»“æ„æ„å»º
```

**å…·ä½“æ­¥éª¤**ï¼š
1. **æœç´¢æŸ¥è¯¢**ï¼šä½¿ç”¨Tavilyæœç´¢å¼•æ“è·å–å®ä½“ç›¸å…³ä¿¡æ¯
2. **æ–‡æœ¬é¢„å¤„ç†**ï¼šæ¸…æ´—ã€åˆ†å—ã€è¿‡æ»¤æœç´¢ç»“æœ
3. **LLMæŠ½å–**ï¼šä½¿ç”¨å¤§æ¨¡å‹ä»æ–‡æœ¬ä¸­æŠ½å–å®ä½“å’Œå…³ç³»
4. **å›¾æ„å»º**ï¼šæ„å»ºåŒ…å«èŠ‚ç‚¹å’Œè¾¹çš„çŸ¥è¯†å­å›¾

#### B. **çŸ¥è¯†å›¾è°±Schema**
```python
# å®ä½“ç»“æ„
{
    "id": "entity_uuid",
    "name": "ç³–å°¿ç—…", 
    "type": "concept",  # person/organization/location/technology/concept/event/time
    "description": "ä¸€ç§æ…¢æ€§ä»£è°¢æ€§ç–¾ç—…"
}

# å…³ç³»ç»“æ„  
{
    "source": "ç³–å°¿ç—…",
    "relation": "å¼•èµ·",
    "target": "é«˜è¡€ç³–",
    "weight": 0.8
}
```

---

### 3. **QAç”Ÿæˆé˜¶æ®µ** ğŸ¯

#### A. **å›¾é‡‡æ ·**
ä½¿ç”¨5ç§é‡‡æ ·ç®—æ³•ä»çŸ¥è¯†å›¾è°±ä¸­é€‰æ‹©å­å›¾ï¼š
- `max_chain`ï¼šæœ€é•¿é“¾é‡‡æ ·
- `augmented_chain`ï¼šä¸»å¹²å¢å¼ºé‡‡æ ·  
- `community_core_path`ï¼šç¤¾ç¾¤æ ¸å¿ƒè·¯å¾„é‡‡æ ·
- `dual_core_bridge`ï¼šåŒæ ¸æ¡¥æ¥é‡‡æ ·
- `mixed`ï¼šæ··åˆé‡‡æ ·

#### B. **é—®ç­”ç”Ÿæˆ**
```python
# ç»Ÿä¸€QAç”Ÿæˆå™¨å¤„ç†æµç¨‹
é‡‡æ ·å­å›¾ â†’ å®ä½“æ¨¡ç³ŠåŒ– â†’ é—®é¢˜ç”Ÿæˆ â†’ ç­”æ¡ˆç”Ÿæˆ â†’ æ¨ç†è·¯å¾„ç”Ÿæˆ
```

**ç”Ÿæˆå‚æ•°**ï¼š
- `max_nodes`: 200-400ï¼ˆå›¾çš„æœ€å¤§èŠ‚ç‚¹æ•°ï¼‰
- `max_iterations`: 5-15ï¼ˆè¿­ä»£æ¬¡æ•°ï¼‰
- `sample_size`: 8-20ï¼ˆæ¯æ¬¡é‡‡æ ·çš„èŠ‚ç‚¹æ•°ï¼‰

---

### 4. **æ‰¹é‡å¤„ç†é˜¶æ®µ** ğŸš€

#### A. **å¹¶å‘å¤„ç†æ¶æ„**
```python
# batch_qa_cli.py å®ç°
async def batch_generate_qa():
    semaphore = asyncio.Semaphore(parallel_workers)  # æ§åˆ¶å¹¶å‘æ•°
    rate_limiter = AsyncRateLimiter(qps_limit)       # æ§åˆ¶QPS
    
    # å¹¶å‘å¤„ç†å¤šä¸ªå®ä½“
    tasks = [process_single_entity(entity) for entity in entities]
    results = await asyncio.gather(*tasks)
```

#### B. **å¤„ç†é…ç½®**
```python
# å…¸å‹ä¼ä¸šçº§é…ç½®
{
    "parallel_workers": 5,        # å¹¶å‘workeræ•°
    "qps_limit": 3,              # APIè°ƒç”¨é¢‘ç‡é™åˆ¶  
    "max_nodes": 300,            # å›¾èŠ‚ç‚¹æ•°
    "max_iterations": 12,        # è¿­ä»£æ¬¡æ•°
    "sampling_algorithm": "max_chain",
    "enable_resume": True,       # æ–­ç‚¹ç»­ä¼ 
    "enable_instant_save": True  # å³æ—¶ä¿å­˜
}
```

---

### 5. **æ•°æ®å¢å¼ºé˜¶æ®µ** ğŸ·ï¸

#### A. **Smart Auto-Tagging**
```python
# è‡ªåŠ¨é¢†åŸŸæ ‡ç­¾åˆ†ç±»
åŸå§‹QAæ•°æ® â†’ LLMè¯­ä¹‰åˆ†æ â†’ é¢†åŸŸæ ‡ç­¾åˆ†é… â†’ å¸¦æ ‡ç­¾æ•°æ®
```

#### B. **æ ‡ç­¾åŒ–å¤„ç†**
```python
# domain_tags_info.json ç®¡ç†
{
    "tags": {
        "åŒ»ç–—": {"count": 156, "description": ""},
        "ç§‘æŠ€": {"count": 89, "description": ""},
        "ç»æµ": {"count": 45, "description": ""}
    },
    "total_processed": 290
}
```

---

### 6. **è´¨é‡æ§åˆ¶é˜¶æ®µ** ğŸ“Š

#### A. **å¤šå±‚è´¨é‡éªŒè¯**
```
è‡ªåŠ¨è¯„ä¼° â†’ äººå·¥å®¡æ ¸ â†’ å¯¹æ¯”åˆ†æ â†’ æ•°æ®æ¸…æ´—
```

#### B. **è´¨é‡æŒ‡æ ‡**
- **å‡†ç¡®æ€§è¯„åˆ†**ï¼šâ‰¥85%
- **è¯­ä¹‰ç›¸ä¼¼åº¦**ï¼šâ‰¥0.8  
- **é€»è¾‘ä¸€è‡´æ€§**ï¼šâ‰¥90%
- **é¢†åŸŸç›¸å…³æ€§**ï¼šâ‰¥95%
- **é‡å¤ç‡**ï¼šâ‰¤5%

---

### 7. **æœ€ç»ˆæ•°æ®è¾“å‡º** ğŸ“¤

#### A. **æ ‡å‡†JSONLæ ¼å¼**
```json
{
    "question": "ç³–å°¿ç—…çš„ä¸»è¦ç—‡çŠ¶æœ‰å“ªäº›ï¼Ÿ",
    "answer": "å¤šé¥®ã€å¤šå°¿ã€å¤šé£Ÿã€ä½“é‡ä¸‹é™ç­‰",
    "reasoning_path": "1. è¯†åˆ«ç–¾ç—…å®ä½“... 2. æŸ¥æ‰¾ç—‡çŠ¶å…³ç³»... 3. ç»¼åˆåˆ†æ...",
    "entity_mapping": {
        "Entity_A": "ç³–å°¿ç—…",
        "Symptom_1": "å¤šé¥®",
        "Symptom_2": "å¤šå°¿"
    },
    "generation_metadata": {
        "generation_method": "unified_obfuscation_qa",
        "nodes_used": 12,
        "obfuscation_strategies": 2
    },
    "source_entity": "ç³–å°¿ç—…",
    "run_id": "20250115_143022_batch_medical_156",
    "sampling_algorithm": "max_chain", 
    "timestamp": "2025-01-15T14:35:18.123456",
    "domain_tags": ["åŒ»ç–—"],           // Smart Auto-Taggingæ·»åŠ 
    "unique_id": "qa_medical_001",     // ç”Ÿäº§éƒ¨ç½²ID
    "quality_score": 0.92             // è´¨é‡è¯„åˆ†
}
```

#### B. **æ–‡ä»¶ç»„ç»‡ç»“æ„**
```
evaluation_data/
â”œâ”€â”€ generated_datasets/           # åŸå§‹ç”Ÿæˆæ•°æ®
â”‚   â””â”€â”€ medical_batch_20250115.jsonl
â”œâ”€â”€ tagged/                      # æ ‡ç­¾åŒ–æ•°æ®  
â”‚   â””â”€â”€ medical_batch_20250115_with_tags.jsonl
â””â”€â”€ final_datasets/              # æœ€ç»ˆç”Ÿäº§æ•°æ®
    â”œâ”€â”€ medical_qa_v1.0.jsonl
    â”œâ”€â”€ domain_tags_info.json
    â””â”€â”€ quality_report.json
```

---

### 8. **ç”Ÿäº§éƒ¨ç½²æµç¨‹** ğŸ¯

#### A. **æœ€ç»ˆæ•°æ®å¯¼å‡º**
```javascript
// æ”¯æŒå¤šç»´åº¦ç­›é€‰å¯¼å‡º
const exportData = filteredData.map(item => {
    return {
        unique_id: item.unique_id,
        question: item.question, 
        answer: item.answer,
        domain_tags: item.domain_tags,
        quality_score: item.quality_score
    };
});

// ç”Ÿæˆéƒ¨ç½²åŒ…
const deploymentPackage = {
    metadata: {
        version: "v2.1.0",
        total_qa_pairs: 3247,
        quality_threshold: 0.85,
        domains: ["åŒ»ç–—", "ç§‘æŠ€", "ç»æµ"]
    },
    data: exportData
};
```

#### B. **éƒ¨ç½²æ ¼å¼**
- **APIæœåŠ¡**ï¼šRESTfulæ¥å£æ ¼å¼
- **æ•°æ®åº“**ï¼šSQL/NoSQLå¯¼å…¥æ ¼å¼
- **è®­ç»ƒé›†**ï¼šæœºå™¨å­¦ä¹ æ¨¡å‹è®­ç»ƒæ ¼å¼
- **çŸ¥è¯†åº“**ï¼šä¼ä¸šçŸ¥è¯†ç®¡ç†ç³»ç»Ÿæ ¼å¼

---

## å®Œæ•´æ•°æ®æµç¤ºä¾‹

```
è¾“å…¥: ["ç³–å°¿ç—…", "é«˜è¡€å‹", "å¿ƒè„ç—…"] (3ä¸ªåŒ»ç–—å®ä½“)
     â†“
çŸ¥è¯†å›¾è°±æ„å»º: æ¯ä¸ªå®ä½“æ„å»ºåŒ…å«20-50ä¸ªèŠ‚ç‚¹çš„çŸ¥è¯†å­å›¾
     â†“  
QAç”Ÿæˆ: æ¯ä¸ªå®ä½“ç”Ÿæˆ8-15ä¸ªé—®ç­”å¯¹ â†’ æ€»è®¡24-45ä¸ªQAå¯¹
     â†“
Smart Auto-Tagging: è‡ªåŠ¨æ ‡è®°ä¸º"åŒ»ç–—"é¢†åŸŸ
     â†“
è´¨é‡æ§åˆ¶: ç­›é€‰å‡ºè´¨é‡è¯„åˆ†â‰¥0.85çš„QAå¯¹ â†’ ä¿ç•™30ä¸ªé«˜è´¨é‡QAå¯¹  
     â†“
æœ€ç»ˆè¾“å‡º: medical_qa_v1.0.jsonl (30ä¸ªç”Ÿäº§å°±ç»ªçš„QAå¯¹)
```

è¿™ä¸ªæµç¨‹å°†**åŸå§‹é¢†åŸŸæœ¯è¯­è½¬åŒ–ä¸ºå¯ç›´æ¥ç”¨äºAIè®­ç»ƒå’Œç”Ÿäº§éƒ¨ç½²çš„é«˜è´¨é‡ç»“æ„åŒ–é—®ç­”æ•°æ®**ï¼Œæ”¯æŒä¼ä¸šçº§è§„æ¨¡çš„çŸ¥è¯†é—®ç­”ç³»ç»Ÿæ„å»ºã€‚

---

### ç”¨æˆ·æŸ¥è¯¢10ï¼šå“ªé‡Œä½“ç°äº†åœ¨ç”Ÿæˆqaæ—¶ï¼Œä¼šç”ŸæˆåŒ…å«è°ƒç”¨toolçš„qa

è®©æˆ‘æœç´¢ç³»ç»Ÿä¸­å…³äºå·¥å…·è°ƒç”¨(tool calling)åŠŸèƒ½çš„å®ç°ã€‚

åŸºäºæ·±å…¥çš„ä»£ç åˆ†æï¼Œæˆ‘ç°åœ¨å¯ä»¥æ¸…æ¥šåœ°è§£é‡Š**åœ¨ç”ŸæˆQAæ—¶ä¼šç”ŸæˆåŒ…å«è°ƒç”¨toolçš„QA**åœ¨å“ªé‡Œä½“ç°ï¼š

## Tool Callingåœ¨QAç”Ÿæˆä¸­çš„ä½“ç°

### 1. **ç³»ç»Ÿæ¶æ„ä¸­çš„ä½ç½®**

è¿™ä¸ªåŠŸèƒ½**ä¸æ˜¯åœ¨KnowledgeGraphConstructionæ¨¡å—ä¸­**ï¼Œè€Œæ˜¯åœ¨**TrajectoryGenerationPipelineï¼ˆè½¨è¿¹ç”Ÿæˆç®¡é“ï¼‰**ä¸­ä½“ç°çš„ï¼š

```
çŸ¥è¯†å›¾è°±æ„å»º â†’ åŸºç¡€QAç”Ÿæˆ â†’ è½¨è¿¹ç”Ÿæˆç®¡é“ï¼ˆTool Callingï¼‰ â†’ æœ€ç»ˆè®­ç»ƒæ•°æ®
     â†“              â†“                    â†“                      â†“
   å®ä½“å…³ç³»        é—®ç­”å¯¹           åŒ…å«å·¥å…·è°ƒç”¨çš„è½¨è¿¹        æ¨¡å‹è®­ç»ƒæ•°æ®
```

### 2. **Tool Callingçš„å…·ä½“å®ç°**

#### A. **å·¥å…·é…ç½®** (`/workspace/tools/tool_config.json`)
```json
{
  "tools": {
    "search": {
      "enabled": true,
      "class": "SearchTool",
      "description": "Performs batched web searches",
      "parameters": {
        "query": {
          "type": "array",
          "items": {"type": "string"}
        }
      }
    },
    "visit": {
      "enabled": true, 
      "class": "VisitTool",
      "description": "Visit webpage(s) and return the summary",
      "parameters": {
        "url": {"type": "array"},
        "goal": {"type": "string"}
      }
    }
  }
}
```

#### B. **Agentå·¥å…·é›†æˆ** (`TrajectoryGenerationPipeline/src/trajectory_generation/langgraph_agent.py`)
```python
from tools import create_tool_manager

class LangGraphAgent:
    def __init__(self):
        # åˆ›å»ºå·¥å…·ç®¡ç†å™¨
        self.tool_manager = create_tool_manager()
        # è·å–å¯ç”¨çš„å·¥å…·
        tools = self.tool_manager.get_enabled_tools(['search', 'visit'])
        # åˆ›å»ºå¸¦å·¥å…·çš„ReAct Agent
        self.agent = create_react_agent(self.llm, tools, state_modifier=self.system_message)
```

### 3. **è½¨è¿¹ç”Ÿæˆä¸­çš„Tool Callingæµç¨‹**

#### A. **ç³»ç»Ÿæç¤ºè¯ä¸­çš„å·¥å…·ä½¿ç”¨æŒ‡å¯¼**
```python
# prompts.pyä¸­çš„ç³»ç»Ÿæç¤º
def get_system_prompt():
    return """ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ä¿¡æ¯ç ”ç©¶åŠ©æ‰‹ã€‚ä½ çš„æ ¸å¿ƒèŒè´£æ˜¯é€šè¿‡åˆç†çš„å·¥å…·ä½¿ç”¨å’Œé€»è¾‘æ¨ç†æ¥è§£å†³å¤æ‚é—®é¢˜ã€‚

**å·¥ä½œæ–¹æ³•**ï¼š
1. **é—®é¢˜åˆ†æ**ï¼šåˆ†æé—®é¢˜æ€§è´¨å’Œæ‰€éœ€ä¿¡æ¯ç±»å‹
2. **åˆç†å·¥å…·ä½¿ç”¨**ï¼šä»…å½“éœ€è¦è·å–å¤–éƒ¨ä¿¡æ¯æ—¶ä½¿ç”¨å·¥å…·ï¼š
   - æœç´¢æœªçŸ¥çš„äº‹å®ã€æ•°æ®ã€æ–°é—»ç­‰
   - è·å–ç½‘é¡µå†…å®¹å’Œå…·ä½“ä¿¡æ¯
   - éªŒè¯æ—¶æ•ˆæ€§å¼ºçš„ä¿¡æ¯
3. **é€»è¾‘æ¨ç†ä¼˜å…ˆ**ï¼šå¯¹äºå¯ä»¥æ¨ç†å¾—å‡ºçš„å†…å®¹ï¼Œåº”ç›´æ¥è¿›è¡Œåˆ†æ
4. **ç»¼åˆåˆ†æ**ï¼šç»“åˆå·¥å…·è·å–çš„å¤–éƒ¨ä¿¡æ¯å’Œè‡ªä¸»æ¨ç†ï¼Œæä¾›å®Œæ•´ç­”æ¡ˆ
"""
```

#### B. **ç”¨æˆ·æç¤ºè¯æ¨¡æ¿**
```python
USER_PROMPT_TEMPLATES = {
    "with_reasoning_zh": """
ä½ æ”¶åˆ°äº†ä¸€äº›æœç´¢æŒ‡å¯¼æç¤ºã€‚è¿™äº›æç¤ºå»ºè®®äº†å¯èƒ½çš„æœç´¢æ–¹å‘å’Œè°ƒæŸ¥æ–¹æ³•ã€‚
ä½ ç»å¯¹ä¸èƒ½ç›´æ¥ä½¿ç”¨è¿™äº›æç¤ºä¸­çš„å…·ä½“ä¿¡æ¯ä½œä¸ºç­”æ¡ˆæˆ–è¿›è¡Œç›´æ¥æ¨ç†ã€‚

## æœç´¢æŒ‡å¯¼ (ä»…ç”¨ä½œæœç´¢æ–¹å‘):
{reasoning_path}

## å…³é”®æŒ‡ä»¤ï¼š
1. **æœç´¢æ–¹å‘**ï¼šä¸Šè¿°æç¤ºä»…ä¸ºæœç´¢ä¸»é¢˜/å…³é”®è¯çš„å»ºè®®
2. **å¼ºåˆ¶å·¥å…·éªŒè¯**ï¼šå¯¹äºæŒ‡å¯¼æç¤ºä¸­æåˆ°çš„ä»»ä½•ä¿¡æ¯ï¼Œä½ å¿…é¡»ä½¿ç”¨å·¥å…·ç‹¬ç«‹æŸ¥æ‰¾ã€éªŒè¯å’Œç¡®è®¤
3. **ç‹¬ç«‹ç ”ç©¶**ï¼šå°†æŒ‡å¯¼è§†ä¸ºç ”ç©¶è·¯çº¿å›¾ï¼Œå¿…é¡»é€šè¿‡å·¥å…·ç‹¬ç«‹å‘ç°ã€éªŒè¯æ‰€æœ‰å…·ä½“ä¿¡æ¯

å½“ä½ å®Œæˆç ”ç©¶æ—¶ï¼Œå…ˆè§£é‡Šä½ çš„å‘ç°ï¼Œç„¶ååœ¨<answer></answer>å†…æä¾›ç­”æ¡ˆã€‚
"""
}
```

### 4. **ç”Ÿæˆçš„Tool Callingè½¨è¿¹æ ¼å¼**

#### A. **è®­ç»ƒæ ¼å¼è½¬æ¢** (`langgraph_agent.py` ç¬¬280è¡Œå¼€å§‹)
```python
def get_trajectory_in_training_format(self, trajectory_messages):
    """
    è½¬æ¢è½¨è¿¹æ¶ˆæ¯ä¸ºè®­ç»ƒæ ¼å¼:
    - system: ä¸“ä¸šåŒ–ç³»ç»Ÿæç¤º
    - user: ä¸“ä¸šåŒ–ç”¨æˆ·æç¤º + é—®é¢˜
    - assistant: <think>å†…å®¹</think>\n\n<tool_call>json</tool_call>
    - user: <tool_response>\nç»“æœ\n</tool_response>
    - assistant: <think>å†…å®¹</think>\n<answer>ç­”æ¡ˆ</answer>
    """
```

#### B. **å®é™…è½¨è¿¹ç¤ºä¾‹**
```json
{
  "messages": [
    {
      "role": "system",
      "content": "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ä¿¡æ¯ç ”ç©¶åŠ©æ‰‹..."
    },
    {
      "role": "user", 
      "content": "å¯¹è¿™ä¸ªé—®é¢˜è¿›è¡Œç ”ç©¶ï¼Œå®Œæˆç ”ç©¶åå›ç­”é—®é¢˜...ç”¨æˆ·é—®é¢˜ï¼šä»€ä¹ˆæ˜¯æœ€æ–°çš„AIæŠ€æœ¯å‘å±•ï¼Ÿ"
    },
    {
      "role": "assistant",
      "content": "<think>\næˆ‘éœ€è¦æœç´¢æœ€æ–°çš„AIæŠ€æœ¯å‘å±•ä¿¡æ¯ï¼Œå› ä¸ºè¿™éœ€è¦å®æ—¶æ•°æ®ã€‚\n</think>\n\n<tool_call>\n{\"query\": [\"2024å¹´æœ€æ–°AIæŠ€æœ¯å‘å±•\", \"äººå·¥æ™ºèƒ½æœ€æ–°çªç ´\"]}\n</tool_call>"
    },
    {
      "role": "user",
      "content": "<tool_response>\næœç´¢ç»“æœæ˜¾ç¤ºï¼šGPT-4ã€Claude-3ç­‰å¤§è¯­è¨€æ¨¡å‹çš„çªç ´...\n</tool_response>"
    },
    {
      "role": "assistant", 
      "content": "<think>\nåŸºäºæœç´¢ç»“æœï¼Œæˆ‘å¯ä»¥æ€»ç»“æœ€æ–°çš„AIæŠ€æœ¯å‘å±•...\n</think>\n\n<answer>2024å¹´AIæŠ€æœ¯çš„ä¸»è¦å‘å±•åŒ…æ‹¬å¤§è¯­è¨€æ¨¡å‹çš„çªç ´ã€å¤šæ¨¡æ€AIçš„è¿›å±•ç­‰...</answer>"
    }
  ]
}
```

### 5. **å·¥å…·è°ƒç”¨çš„è´¨é‡è¿‡æ»¤**

#### A. **å·¥å…·è°ƒç”¨éªŒè¯** (`filtering/filter.py`)
```python
def count_function_calls(self, messages):
    """ç»Ÿè®¡è½¨è¿¹ä¸­çš„å‡½æ•°è°ƒç”¨æ¬¡æ•°"""
    function_call_count = 0
    for message in messages:
        if message.get("role") == "assistant":
            content = message.get("content", "")
            # ç»Ÿè®¡<tool_call>æ ‡ç­¾
            function_call_count += len(re.findall(r'<tool_call>', content))
    return function_call_count

def validate_tool_responses(self, messages):
    """éªŒè¯æ‰€æœ‰å·¥å…·è°ƒç”¨éƒ½æœ‰æœ‰æ•ˆå“åº”"""
    tool_calls = re.findall(r'<tool_call>', content)
    # éªŒè¯å·¥å…·è°ƒç”¨å’Œå“åº”çš„åŒ¹é…
```

#### B. **è´¨é‡æ ‡å‡†**
```python
# è¿‡æ»¤æ ‡å‡†
{
    "max_function_calls": 10,  # æœ€å¤§å·¥å…·è°ƒç”¨æ¬¡æ•°
    "require_valid_tool_responses": True,  # è¦æ±‚æœ‰æ•ˆçš„å·¥å…·å“åº”
    "max_token_length": 40000,  # æœ€å¤§tokené•¿åº¦
}
```

### 6. **å®Œæ•´çš„Tool Callingæ•°æ®ç”Ÿæˆæµç¨‹**

```
1. åŸºç¡€QAç”Ÿæˆï¼ˆKnowledgeGraphConstructionï¼‰
   â†“
2. æ·»åŠ æ¨ç†è·¯å¾„æŒ‡å¯¼ï¼ˆreasoning_pathï¼‰
   â†“  
3. è½¨è¿¹ç”Ÿæˆç®¡é“ï¼ˆTrajectoryGenerationPipelineï¼‰
   â”œâ”€â”€ Agentæ¥æ”¶QA + reasoning_path
   â”œâ”€â”€ åˆ†æéœ€è¦çš„å¤–éƒ¨ä¿¡æ¯
   â”œâ”€â”€ è°ƒç”¨search/visitå·¥å…·è·å–ä¿¡æ¯
   â”œâ”€â”€ åŸºäºå·¥å…·ç»“æœè¿›è¡Œæ¨ç†
   â””â”€â”€ ç”ŸæˆåŒ…å«å·¥å…·è°ƒç”¨çš„å®Œæ•´è½¨è¿¹
   â†“
4. è´¨é‡è¿‡æ»¤å’Œé‡å†™ä¼˜åŒ–
   â†“
5. æœ€ç»ˆè®­ç»ƒæ•°æ®ï¼ˆåŒ…å«Tool Callingçš„å¤šè½®å¯¹è¯ï¼‰
```

### 7. **æ•°æ®è¾“å‡ºç¤ºä¾‹**

æœ€ç»ˆç”Ÿæˆçš„åŒ…å«å·¥å…·è°ƒç”¨çš„è®­ç»ƒæ•°æ®ä¼šåŒ…å«ï¼š
- **<tool_call>** æ ‡ç­¾ï¼šè¡¨ç¤ºå·¥å…·è°ƒç”¨
- **<tool_response>** æ ‡ç­¾ï¼šè¡¨ç¤ºå·¥å…·å“åº”
- **<think>** æ ‡ç­¾ï¼šè¡¨ç¤ºæ¨ç†è¿‡ç¨‹
- **<answer>** æ ‡ç­¾ï¼šè¡¨ç¤ºæœ€ç»ˆç­”æ¡ˆ

## æ€»ç»“

**Tool CallingåŠŸèƒ½ä¸»è¦ä½“ç°åœ¨TrajectoryGenerationPipelineæ¨¡å—ä¸­**ï¼Œå®ƒå°†KnowledgeGraphConstructionç”Ÿæˆçš„åŸºç¡€QAå¯¹è½¬æ¢ä¸ºåŒ…å«å·¥å…·è°ƒç”¨çš„å¤šè½®æ¨ç†è½¨è¿¹ï¼Œç”¨äºè®­ç»ƒèƒ½å¤Ÿä½¿ç”¨å¤–éƒ¨å·¥å…·çš„æ¨ç†æ¨¡å‹ã€‚è¿™ä¸ªåŠŸèƒ½ä½¿å¾—ç”Ÿæˆçš„è®­ç»ƒæ•°æ®ä¸ä»…åŒ…å«é—®ç­”å¯¹ï¼Œè¿˜åŒ…å«äº†å¦‚ä½•ä½¿ç”¨æœç´¢å’Œç½‘é¡µè®¿é—®å·¥å…·æ¥è·å–å¤–éƒ¨ä¿¡æ¯å¹¶è¿›è¡Œæ¨ç†çš„å®Œæ•´è¿‡ç¨‹ã€‚